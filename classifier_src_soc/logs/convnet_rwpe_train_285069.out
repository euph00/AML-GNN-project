==========================================
Job ID: 285069
Job Name: train_convnet_rwpe
Node: xgpk0
Start Time: Sat Nov 15 03:18:05 PM +08 2025
GPU Information:
Sat Nov 15 15:18:05 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H200 NVL                On  |   00000000:71:00.0 Off |                    0 |
| N/A   32C    P0             70W /  600W |       0MiB / 143771MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==========================================
Conda environment 'aml_project_new' already exists. Activating it...
Working directory: /home/l/linchieh/AML-GNN-project/classifier_src_soc
==========================================
Starting fine-tuning...
Output directory: ./saved_models/
Epochs: 100
Learning rate: 1e-4
==========================================
Warning: Looks like you're using an outdated `kagglehub` version, please consider updating (latest version: 0.3.13)
Path to dataset files: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8
Loading HI-Small...


Loading transactions from: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8/HI-Small_Trans.csv
File size: 453.6 MB

Loaded 5,078,345 transactions
Date range: 2022-09-01 00:00:00 to 2022-09-18 16:18:00
Laundering transactions: 5,177 (0.102%)
============================================================
TEMPORAL TRAIN/TEST SPLIT
============================================================

Train Set:
  Date range: 2022-09-01 00:00:00 to 2022-09-08 16:12:00
  Transactions: 4,062,676
  Laundering: 3,380 (0.083%)

Test Set:
  Date range: 2022-09-08 16:12:00 to 2022-09-18 16:18:00
  Transactions: 1,015,669
  Laundering: 1,797 (0.177%)
============================================================
Number of nodes: 515080
Number of edges: 4062676
Adding RWPE feats
cpu
soc_convnet_rwpe.py:96: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at /opt/conda/conda-bld/pytorch_1702400400184/work/aten/src/ATen/SparseCsrTensorImpl.cpp:53.)
  P = torch.sparse.mm(D_inv, A)
Added RWPE feats
Number of nodes: 515080
Number of edges: 1015669
Adding RWPE feats
cpu
Added RWPE feats
Class weights: tensor([  1., 800.], device='cuda:0')

============================================================
TRAINING
============================================================

Epoch   0 | Loss: 0.6972 | Acc: 0.7147
  Class 1 - P: 0.0007, R: 0.2462, F1: 0.0014
  Predicting class 1: 28.49078%
  Saved best model (F1: 0.0014)

Epoch   1 | Loss: 0.6939 | Acc: 0.9486
  Class 1 - P: 0.0015, R: 0.0920, F1: 0.0030
  Predicting class 1: 5.07109%
  Saved best model (F1: 0.0030)

Epoch   2 | Loss: 0.6917 | Acc: 0.9928
  Class 1 - P: 0.0040, R: 0.0305, F1: 0.0070
  Predicting class 1: 0.63882%
  Saved best model (F1: 0.0070)

Epoch   3 | Loss: 0.6896 | Acc: 0.9985
  Class 1 - P: 0.0059, R: 0.0047, F1: 0.0053
  Predicting class 1: 0.06661%

Epoch   4 | Loss: 0.6881 | Acc: 0.9987
  Class 1 - P: 0.0015, R: 0.0009, F1: 0.0011
  Predicting class 1: 0.04915%

Epoch   5 | Loss: 0.6857 | Acc: 0.9852
  Class 1 - P: 0.0013, R: 0.0225, F1: 0.0025
  Predicting class 1: 1.40144%

Epoch   6 | Loss: 0.6834 | Acc: 0.9652
  Class 1 - P: 0.0014, R: 0.0586, F1: 0.0028
  Predicting class 1: 3.40987%

Epoch   7 | Loss: 0.6826 | Acc: 0.9538
  Class 1 - P: 0.0015, R: 0.0820, F1: 0.0029
  Predicting class 1: 4.54683%

Epoch   8 | Loss: 0.6804 | Acc: 0.9494
  Class 1 - P: 0.0015, R: 0.0888, F1: 0.0029
  Predicting class 1: 4.99412%

Epoch   9 | Loss: 0.6785 | Acc: 0.9478
  Class 1 - P: 0.0015, R: 0.0914, F1: 0.0029
  Predicting class 1: 5.14757%

Epoch  10 | Loss: 0.6774 | Acc: 0.9472
  Class 1 - P: 0.0015, R: 0.0926, F1: 0.0029
  Predicting class 1: 5.21521%

Epoch  11 | Loss: 0.6756 | Acc: 0.9467
  Class 1 - P: 0.0015, R: 0.0935, F1: 0.0029
  Predicting class 1: 5.26431%

Epoch  12 | Loss: 0.6730 | Acc: 0.9463
  Class 1 - P: 0.0015, R: 0.0941, F1: 0.0029
  Predicting class 1: 5.30397%

Epoch  13 | Loss: 0.6712 | Acc: 0.9458
  Class 1 - P: 0.0015, R: 0.0947, F1: 0.0029
  Predicting class 1: 5.35132%

Epoch  14 | Loss: 0.6700 | Acc: 0.9452
  Class 1 - P: 0.0015, R: 0.0967, F1: 0.0029
  Predicting class 1: 5.40914%

Epoch  15 | Loss: 0.6690 | Acc: 0.9446
  Class 1 - P: 0.0015, R: 0.0985, F1: 0.0029
  Predicting class 1: 5.47609%

Epoch  16 | Loss: 0.6676 | Acc: 0.9436
  Class 1 - P: 0.0015, R: 0.1000, F1: 0.0029
  Predicting class 1: 5.56975%

Epoch  17 | Loss: 0.6653 | Acc: 0.9424
  Class 1 - P: 0.0015, R: 0.1018, F1: 0.0029
  Predicting class 1: 5.69511%

Epoch  18 | Loss: 0.6644 | Acc: 0.9408
  Class 1 - P: 0.0015, R: 0.1044, F1: 0.0029
  Predicting class 1: 5.85452%

Epoch  19 | Loss: 0.6630 | Acc: 0.9391
  Class 1 - P: 0.0015, R: 0.1065, F1: 0.0029
  Predicting class 1: 6.02891%

Epoch  20 | Loss: 0.6625 | Acc: 0.9370
  Class 1 - P: 0.0015, R: 0.1095, F1: 0.0029
  Predicting class 1: 6.23030%

Epoch  21 | Loss: 0.6603 | Acc: 0.9349
  Class 1 - P: 0.0014, R: 0.1115, F1: 0.0028
  Predicting class 1: 6.44789%

Epoch  22 | Loss: 0.6592 | Acc: 0.9326
  Class 1 - P: 0.0014, R: 0.1154, F1: 0.0028
  Predicting class 1: 6.67218%

Epoch  23 | Loss: 0.6579 | Acc: 0.9307
  Class 1 - P: 0.0014, R: 0.1186, F1: 0.0028
  Predicting class 1: 6.86166%

Epoch  24 | Loss: 0.6595 | Acc: 0.9292
  Class 1 - P: 0.0014, R: 0.1213, F1: 0.0028
  Predicting class 1: 7.02190%

Epoch  25 | Loss: 0.6558 | Acc: 0.9276
  Class 1 - P: 0.0014, R: 0.1231, F1: 0.0028
  Predicting class 1: 7.17968%

Epoch  26 | Loss: 0.6551 | Acc: 0.9261
  Class 1 - P: 0.0014, R: 0.1263, F1: 0.0028
  Predicting class 1: 7.33268%

Epoch  27 | Loss: 0.6528 | Acc: 0.9246
  Class 1 - P: 0.0015, R: 0.1320, F1: 0.0029
  Predicting class 1: 7.47630%

Epoch  28 | Loss: 0.6523 | Acc: 0.9235
  Class 1 - P: 0.0015, R: 0.1349, F1: 0.0029
  Predicting class 1: 7.59280%

Epoch  29 | Loss: 0.6511 | Acc: 0.9225
  Class 1 - P: 0.0015, R: 0.1426, F1: 0.0031
  Predicting class 1: 7.69217%

Epoch  30 | Loss: 0.6484 | Acc: 0.9216
  Class 1 - P: 0.0017, R: 0.1583, F1: 0.0033
  Predicting class 1: 7.77926%

Epoch  31 | Loss: 0.6480 | Acc: 0.9207
  Class 1 - P: 0.0018, R: 0.1716, F1: 0.0036
  Predicting class 1: 7.87560%

Epoch  32 | Loss: 0.6472 | Acc: 0.9198
  Class 1 - P: 0.0020, R: 0.1914, F1: 0.0040
  Predicting class 1: 7.97061%

Epoch  33 | Loss: 0.6452 | Acc: 0.9187
  Class 1 - P: 0.0022, R: 0.2104, F1: 0.0043
  Predicting class 1: 8.08489%

Epoch  34 | Loss: 0.6436 | Acc: 0.9174
  Class 1 - P: 0.0023, R: 0.2299, F1: 0.0046
  Predicting class 1: 8.21911%

Epoch  35 | Loss: 0.6413 | Acc: 0.9157
  Class 1 - P: 0.0025, R: 0.2509, F1: 0.0049
  Predicting class 1: 8.39053%

Epoch  36 | Loss: 0.6407 | Acc: 0.9139
  Class 1 - P: 0.0026, R: 0.2707, F1: 0.0052
  Predicting class 1: 8.56891%

Epoch  37 | Loss: 0.6391 | Acc: 0.9126
  Class 1 - P: 0.0027, R: 0.2837, F1: 0.0054
  Predicting class 1: 8.70665%

Epoch  38 | Loss: 0.6410 | Acc: 0.9117
  Class 1 - P: 0.0028, R: 0.2932, F1: 0.0055
  Predicting class 1: 8.79285%

Epoch  39 | Loss: 0.6356 | Acc: 0.9110
  Class 1 - P: 0.0028, R: 0.3036, F1: 0.0056
  Predicting class 1: 8.86499%

Epoch  40 | Loss: 0.6353 | Acc: 0.9102
  Class 1 - P: 0.0029, R: 0.3142, F1: 0.0058
  Predicting class 1: 8.95173%

Epoch  41 | Loss: 0.6322 | Acc: 0.9092
  Class 1 - P: 0.0030, R: 0.3228, F1: 0.0059
  Predicting class 1: 9.04901%

Epoch  42 | Loss: 0.6297 | Acc: 0.9076
  Class 1 - P: 0.0030, R: 0.3352, F1: 0.0060
  Predicting class 1: 9.21334%

Epoch  43 | Loss: 0.6300 | Acc: 0.9051
  Class 1 - P: 0.0031, R: 0.3544, F1: 0.0062
  Predicting class 1: 9.46197%

Epoch  44 | Loss: 0.6272 | Acc: 0.9018
  Class 1 - P: 0.0032, R: 0.3766, F1: 0.0063
  Predicting class 1: 9.80322%

Epoch  45 | Loss: 0.6262 | Acc: 0.8975
  Class 1 - P: 0.0033, R: 0.3997, F1: 0.0064
  Predicting class 1: 10.22895%

Epoch  46 | Loss: 0.6245 | Acc: 0.8927
  Class 1 - P: 0.0033, R: 0.4216, F1: 0.0065
  Predicting class 1: 10.71875%

Epoch  47 | Loss: 0.6220 | Acc: 0.8871
  Class 1 - P: 0.0033, R: 0.4447, F1: 0.0065
  Predicting class 1: 11.27680%

Epoch  48 | Loss: 0.6193 | Acc: 0.8818
  Class 1 - P: 0.0033, R: 0.4621, F1: 0.0065
  Predicting class 1: 11.81625%

Epoch  49 | Loss: 0.6186 | Acc: 0.8779
  Class 1 - P: 0.0032, R: 0.4766, F1: 0.0065
  Predicting class 1: 12.20385%

Epoch  50 | Loss: 0.6149 | Acc: 0.8755
  Class 1 - P: 0.0032, R: 0.4852, F1: 0.0064
  Predicting class 1: 12.45132%

Epoch  51 | Loss: 0.6137 | Acc: 0.8733
  Class 1 - P: 0.0032, R: 0.4944, F1: 0.0065
  Predicting class 1: 12.66544%

Epoch  52 | Loss: 0.6131 | Acc: 0.8709
  Class 1 - P: 0.0032, R: 0.5036, F1: 0.0064
  Predicting class 1: 12.90893%

Epoch  53 | Loss: 0.6102 | Acc: 0.8689
  Class 1 - P: 0.0032, R: 0.5089, F1: 0.0064
  Predicting class 1: 13.10737%

Epoch  54 | Loss: 0.6069 | Acc: 0.8665
  Class 1 - P: 0.0032, R: 0.5198, F1: 0.0064
  Predicting class 1: 13.35573%

Epoch  55 | Loss: 0.6067 | Acc: 0.8632
  Class 1 - P: 0.0032, R: 0.5340, F1: 0.0065
  Predicting class 1: 13.68750%

Epoch  56 | Loss: 0.6039 | Acc: 0.8593
  Class 1 - P: 0.0033, R: 0.5533, F1: 0.0065
  Predicting class 1: 14.07875%

Epoch  57 | Loss: 0.5992 | Acc: 0.8552
  Class 1 - P: 0.0033, R: 0.5698, F1: 0.0065
  Predicting class 1: 14.48966%

Epoch  58 | Loss: 0.5967 | Acc: 0.8525
  Class 1 - P: 0.0033, R: 0.5796, F1: 0.0065
  Predicting class 1: 14.76310%

Epoch  59 | Loss: 0.5959 | Acc: 0.8505
  Class 1 - P: 0.0033, R: 0.5876, F1: 0.0065
  Predicting class 1: 14.96782%

Epoch  60 | Loss: 0.5920 | Acc: 0.8484
  Class 1 - P: 0.0033, R: 0.5982, F1: 0.0065
  Predicting class 1: 15.17802%

Epoch  61 | Loss: 0.5883 | Acc: 0.8457
  Class 1 - P: 0.0033, R: 0.6101, F1: 0.0065
  Predicting class 1: 15.44600%

Epoch  62 | Loss: 0.5874 | Acc: 0.8439
  Class 1 - P: 0.0033, R: 0.6163, F1: 0.0065
  Predicting class 1: 15.62665%

Epoch  63 | Loss: 0.5860 | Acc: 0.8406
  Class 1 - P: 0.0033, R: 0.6314, F1: 0.0065
  Predicting class 1: 15.96581%

Epoch  64 | Loss: 0.5833 | Acc: 0.8375
  Class 1 - P: 0.0033, R: 0.6464, F1: 0.0066
  Predicting class 1: 16.26957%

Epoch  65 | Loss: 0.5766 | Acc: 0.8344
  Class 1 - P: 0.0033, R: 0.6586, F1: 0.0066
  Predicting class 1: 16.58203%

Epoch  66 | Loss: 0.5754 | Acc: 0.8308
  Class 1 - P: 0.0033, R: 0.6722, F1: 0.0066
  Predicting class 1: 16.95163%

Epoch  67 | Loss: 0.5708 | Acc: 0.8281
  Class 1 - P: 0.0033, R: 0.6799, F1: 0.0065
  Predicting class 1: 17.21919%

Epoch  68 | Loss: 0.5682 | Acc: 0.8278
  Class 1 - P: 0.0033, R: 0.6834, F1: 0.0066
  Predicting class 1: 17.25124%

Epoch  69 | Loss: 0.5652 | Acc: 0.8272
  Class 1 - P: 0.0033, R: 0.6891, F1: 0.0066
  Predicting class 1: 17.31489%

Epoch  70 | Loss: 0.5645 | Acc: 0.8254
  Class 1 - P: 0.0033, R: 0.6944, F1: 0.0066
  Predicting class 1: 17.48997%

Epoch  71 | Loss: 0.5599 | Acc: 0.8202
  Class 1 - P: 0.0033, R: 0.7083, F1: 0.0065
  Predicting class 1: 18.01640%

Epoch  72 | Loss: 0.5557 | Acc: 0.8154
  Class 1 - P: 0.0033, R: 0.7231, F1: 0.0065
  Predicting class 1: 18.49712%

Epoch  73 | Loss: 0.5554 | Acc: 0.8094
  Class 1 - P: 0.0032, R: 0.7376, F1: 0.0064
  Predicting class 1: 19.09918%

Epoch  74 | Loss: 0.5479 | Acc: 0.8113
  Class 1 - P: 0.0033, R: 0.7391, F1: 0.0065
  Predicting class 1: 18.91145%

Epoch  75 | Loss: 0.5479 | Acc: 0.8159
  Class 1 - P: 0.0033, R: 0.7370, F1: 0.0066
  Predicting class 1: 18.44486%

Epoch  76 | Loss: 0.5436 | Acc: 0.8192
  Class 1 - P: 0.0034, R: 0.7349, F1: 0.0067
  Predicting class 1: 18.12222%

Epoch  77 | Loss: 0.5432 | Acc: 0.8176
  Class 1 - P: 0.0034, R: 0.7426, F1: 0.0067
  Predicting class 1: 18.28024%

Epoch  78 | Loss: 0.5422 | Acc: 0.8128
  Class 1 - P: 0.0034, R: 0.7568, F1: 0.0067
  Predicting class 1: 18.76758%

Epoch  79 | Loss: 0.5352 | Acc: 0.8059
  Class 1 - P: 0.0033, R: 0.7734, F1: 0.0066
  Predicting class 1: 19.45476%

Epoch  80 | Loss: 0.5285 | Acc: 0.8063
  Class 1 - P: 0.0033, R: 0.7757, F1: 0.0066
  Predicting class 1: 19.42033%

Epoch  81 | Loss: 0.5293 | Acc: 0.8109
  Class 1 - P: 0.0034, R: 0.7734, F1: 0.0068
  Predicting class 1: 18.95785%

Epoch  82 | Loss: 0.5289 | Acc: 0.8126
  Class 1 - P: 0.0034, R: 0.7781, F1: 0.0069
  Predicting class 1: 18.78944%

Epoch  83 | Loss: 0.5223 | Acc: 0.8071
  Class 1 - P: 0.0034, R: 0.7885, F1: 0.0068
  Predicting class 1: 19.33620%

Epoch  84 | Loss: 0.5202 | Acc: 0.8063
  Class 1 - P: 0.0034, R: 0.7950, F1: 0.0068
  Predicting class 1: 19.41791%

Epoch  85 | Loss: 0.5179 | Acc: 0.8081
  Class 1 - P: 0.0034, R: 0.7973, F1: 0.0069
  Predicting class 1: 19.24212%

Epoch  86 | Loss: 0.5122 | Acc: 0.8117
  Class 1 - P: 0.0035, R: 0.7962, F1: 0.0070
  Predicting class 1: 18.87640%

Epoch  87 | Loss: 0.5116 | Acc: 0.8061
  Class 1 - P: 0.0035, R: 0.8107, F1: 0.0069
  Predicting class 1: 19.44260%

Epoch  88 | Loss: 0.5141 | Acc: 0.8008
  Class 1 - P: 0.0034, R: 0.8231, F1: 0.0068
  Predicting class 1: 19.97270%

Epoch  89 | Loss: 0.5068 | Acc: 0.8000
  Class 1 - P: 0.0034, R: 0.8266, F1: 0.0068
  Predicting class 1: 20.05481%

Epoch  90 | Loss: 0.5001 | Acc: 0.8005
  Class 1 - P: 0.0035, R: 0.8299, F1: 0.0069
  Predicting class 1: 20.00502%

Epoch  91 | Loss: 0.5022 | Acc: 0.8145
  Class 1 - P: 0.0036, R: 0.8160, F1: 0.0073
  Predicting class 1: 18.60456%
  Saved best model (F1: 0.0073)

Epoch  92 | Loss: 0.4984 | Acc: 0.8124
  Class 1 - P: 0.0036, R: 0.8237, F1: 0.0073
  Predicting class 1: 18.81666%

Epoch  93 | Loss: 0.4916 | Acc: 0.7918
  Class 1 - P: 0.0034, R: 0.8497, F1: 0.0067
  Predicting class 1: 20.88104%

Epoch  94 | Loss: 0.4887 | Acc: 0.7853
  Class 1 - P: 0.0033, R: 0.8604, F1: 0.0066
  Predicting class 1: 21.52921%

Epoch  95 | Loss: 0.4872 | Acc: 0.7910
  Class 1 - P: 0.0034, R: 0.8580, F1: 0.0068
  Predicting class 1: 20.96096%

Epoch  96 | Loss: 0.4842 | Acc: 0.7985
  Class 1 - P: 0.0035, R: 0.8524, F1: 0.0070
  Predicting class 1: 20.20572%

Epoch  97 | Loss: 0.4780 | Acc: 0.8049
  Class 1 - P: 0.0036, R: 0.8453, F1: 0.0072
  Predicting class 1: 19.57242%

Epoch  98 | Loss: 0.4780 | Acc: 0.7873
  Class 1 - P: 0.0034, R: 0.8666, F1: 0.0067
  Predicting class 1: 21.33101%

Epoch  99 | Loss: 0.4794 | Acc: 0.7741
  Class 1 - P: 0.0032, R: 0.8840, F1: 0.0065
  Predicting class 1: 22.65221%

============================================================
TRAINING COMPLETE
============================================================
Class 0: 1013872 (99.82%)
Class 1: 1797 (0.18%)

============================================================
TEST SET RESULTS
============================================================
Overall Accuracy: 0.8609
AUC-ROC: 0.9003

Confusion Matrix:
  TN:  872954  FP:  140918
  FN:     394  TP:    1403

Class 0 (Legitimate):
  Precision: 0.9995
  Recall: 0.8610

Class 1 (Laundering):
  Precision: 0.0099
  Recall: 0.7807
  F1 Score: 0.0195
============================================================

============================================================
EVALUATION COMPLETE
============================================================
==========================================
Training completed successfully!
Output saved to: ./saved_models/
==========================================
Job completed at: Sat Nov 15 03:31:03 PM +08 2025
==========================================
