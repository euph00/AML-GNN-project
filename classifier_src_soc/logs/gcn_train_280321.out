==========================================
Job ID: 280321
Job Name: dgl_gnn_train
Node: xgpi15
Start Time: Wed Nov 12 12:37:52 PM +08 2025
GPU Information:
Wed Nov 12 12:37:52 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 NVL                On  |   00000000:82:00.0 Off |                   On |
| N/A   69C    P0            211W /  400W |   42079MiB /  95830MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  0    1   0   0  |              44MiB / 47488MiB    | 60      0 |  3   0    3    0    3 |
|                  |                 0MiB / 65535MiB  |           |                       |
+------------------+----------------------------------+-----------+-----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==========================================
Conda environment 'aml_project_new' already exists. Activating it...
Working directory: /home/l/linchieh/AML-GNN-project/classifier_src_soc
==========================================
Starting fine-tuning...
Output directory: ./saved_models/
Epochs: 100
Learning rate: 1e-4
==========================================
Preparing dataset
Warning: Looks like you're using an outdated `kagglehub` version, please consider updating (latest version: 0.3.13)
Path to dataset files: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8
Begin main loop
CUDA available: True
Loading HI-Small...


Loading transactions from: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8/HI-Small_Trans.csv
File size: 453.6 MB

Loaded 5,078,345 transactions
Date range: 2022-09-01 00:00:00 to 2022-09-18 16:18:00
Laundering transactions: 5,177 (0.102%)
============================================================
TEMPORAL TRAIN/TEST SPLIT
============================================================

Train Set:
  Date range: 2022-09-01 00:00:00 to 2022-09-08 16:12:00
  Transactions: 4,062,676
  Laundering: 3,380 (0.083%)

Test Set:
  Date range: 2022-09-08 16:12:00 to 2022-09-18 16:18:00
  Transactions: 1,015,669
  Laundering: 1,797 (0.177%)
============================================================
Number of nodes: 515080
Number of edges: 4062676
Number of nodes: 515080
Number of edges: 1015669
Class weights: tensor([ 1., 40.], device='cuda:0')

============================================================
TRAINING
============================================================

Epoch   0 | Loss: 0.7108 | Acc: 0.7942
  Class 1 - P: 0.0011, R: 0.2651, F1: 0.0021
  Predicting class 1: 20.54286%
  Saved best model (F1: 0.0021)
Epoch   1 | Loss: 0.7093

Epoch   2 | Loss: 0.7046 | Acc: 0.6901
  Class 1 - P: 0.0011, R: 0.3970, F1: 0.0021
  Predicting class 1: 30.97554%
Epoch   3 | Loss: 0.6980

Epoch   4 | Loss: 0.7118 | Acc: 0.6121
  Class 1 - P: 0.0010, R: 0.4817, F1: 0.0021
  Predicting class 1: 38.78540%
Epoch   5 | Loss: 0.7004

Epoch   6 | Loss: 0.7085 | Acc: 0.5461
  Class 1 - P: 0.0010, R: 0.5660, F1: 0.0021
  Predicting class 1: 45.40015%
Epoch   7 | Loss: 0.7014

Epoch   8 | Loss: 0.6964 | Acc: 0.5011
  Class 1 - P: 0.0010, R: 0.6189, F1: 0.0021
  Predicting class 1: 49.90792%
Epoch   9 | Loss: 0.7156

Epoch  10 | Loss: 0.6945 | Acc: 0.4638
  Class 1 - P: 0.0010, R: 0.6621, F1: 0.0021
  Predicting class 1: 53.64698%
Epoch  11 | Loss: 0.6913

Epoch  12 | Loss: 0.6951 | Acc: 0.4464
  Class 1 - P: 0.0010, R: 0.6885, F1: 0.0021
  Predicting class 1: 55.39538%
Epoch  13 | Loss: 0.7003

Epoch  14 | Loss: 0.6890 | Acc: 0.4405
  Class 1 - P: 0.0011, R: 0.7077, F1: 0.0021
  Predicting class 1: 55.98283%
Epoch  15 | Loss: 0.6908

Epoch  16 | Loss: 0.7042 | Acc: 0.4456
  Class 1 - P: 0.0011, R: 0.7201, F1: 0.0022
  Predicting class 1: 55.47831%
  Saved best model (F1: 0.0022)
Epoch  17 | Loss: 0.6880

Epoch  18 | Loss: 0.6883 | Acc: 0.4569
  Class 1 - P: 0.0011, R: 0.7269, F1: 0.0022
  Predicting class 1: 54.34541%
  Saved best model (F1: 0.0022)
Epoch  19 | Loss: 0.6924

Epoch  20 | Loss: 0.6863 | Acc: 0.4744
  Class 1 - P: 0.0012, R: 0.7331, F1: 0.0023
  Predicting class 1: 52.59880%
  Saved best model (F1: 0.0023)
Epoch  21 | Loss: 0.6938

Epoch  22 | Loss: 0.6952 | Acc: 0.5009
  Class 1 - P: 0.0012, R: 0.7296, F1: 0.0024
  Predicting class 1: 49.94887%
  Saved best model (F1: 0.0024)
Epoch  23 | Loss: 0.6864

Epoch  24 | Loss: 0.6908 | Acc: 0.5290
  Class 1 - P: 0.0013, R: 0.7195, F1: 0.0025
  Predicting class 1: 47.13858%
  Saved best model (F1: 0.0025)
Epoch  25 | Loss: 0.6842

Epoch  26 | Loss: 0.6801 | Acc: 0.5565
  Class 1 - P: 0.0013, R: 0.7121, F1: 0.0027
  Predicting class 1: 44.38254%
  Saved best model (F1: 0.0027)
Epoch  27 | Loss: 0.6889

Epoch  28 | Loss: 0.6835 | Acc: 0.5853
  Class 1 - P: 0.0014, R: 0.7030, F1: 0.0028
  Predicting class 1: 41.50291%
  Saved best model (F1: 0.0028)
Epoch  29 | Loss: 0.6814

Epoch  30 | Loss: 0.6795 | Acc: 0.6094
  Class 1 - P: 0.0015, R: 0.6923, F1: 0.0029
  Predicting class 1: 39.09083%
  Saved best model (F1: 0.0029)
Epoch  31 | Loss: 0.6832

Epoch  32 | Loss: 0.6820 | Acc: 0.6267
  Class 1 - P: 0.0015, R: 0.6864, F1: 0.0031
  Predicting class 1: 37.36072%
  Saved best model (F1: 0.0031)
Epoch  33 | Loss: 0.6780

Epoch  34 | Loss: 0.6799 | Acc: 0.6403
  Class 1 - P: 0.0016, R: 0.6861, F1: 0.0032
  Predicting class 1: 36.00511%
  Saved best model (F1: 0.0032)
Epoch  35 | Loss: 0.6800

Epoch  36 | Loss: 0.6820 | Acc: 0.6527
  Class 1 - P: 0.0016, R: 0.6825, F1: 0.0033
  Predicting class 1: 34.76369%
  Saved best model (F1: 0.0033)
Epoch  37 | Loss: 0.6813

Epoch  38 | Loss: 0.6769 | Acc: 0.6596
  Class 1 - P: 0.0017, R: 0.6858, F1: 0.0033
  Predicting class 1: 34.06833%
  Saved best model (F1: 0.0033)
Epoch  39 | Loss: 0.6802

Epoch  40 | Loss: 0.6788 | Acc: 0.6632
  Class 1 - P: 0.0017, R: 0.6920, F1: 0.0034
  Predicting class 1: 33.71140%
  Saved best model (F1: 0.0034)
Epoch  41 | Loss: 0.6741

Epoch  42 | Loss: 0.6747 | Acc: 0.6650
  Class 1 - P: 0.0017, R: 0.7012, F1: 0.0035
  Predicting class 1: 33.53644%
  Saved best model (F1: 0.0035)
Epoch  43 | Loss: 0.6787

Epoch  44 | Loss: 0.6769 | Acc: 0.6669
  Class 1 - P: 0.0018, R: 0.7059, F1: 0.0035
  Predicting class 1: 33.34484%
  Saved best model (F1: 0.0035)
Epoch  45 | Loss: 0.6753

Epoch  46 | Loss: 0.6732 | Acc: 0.6664
  Class 1 - P: 0.0018, R: 0.7139, F1: 0.0035
  Predicting class 1: 33.39619%
  Saved best model (F1: 0.0035)
Epoch  47 | Loss: 0.6748

Epoch  48 | Loss: 0.6719 | Acc: 0.6616
  Class 1 - P: 0.0018, R: 0.7260, F1: 0.0036
  Predicting class 1: 33.87265%
  Saved best model (F1: 0.0036)
Epoch  49 | Loss: 0.6725

Epoch  50 | Loss: 0.6700 | Acc: 0.6554
  Class 1 - P: 0.0018, R: 0.7402, F1: 0.0036
  Predicting class 1: 34.49615%
  Saved best model (F1: 0.0036)
Epoch  51 | Loss: 0.6783

Epoch  52 | Loss: 0.6706 | Acc: 0.6508
  Class 1 - P: 0.0018, R: 0.7494, F1: 0.0036
  Predicting class 1: 34.96141%
Epoch  53 | Loss: 0.6731

Epoch  54 | Loss: 0.6666 | Acc: 0.6491
  Class 1 - P: 0.0018, R: 0.7556, F1: 0.0036
  Predicting class 1: 35.13736%
  Saved best model (F1: 0.0036)
Epoch  55 | Loss: 0.6680

Epoch  56 | Loss: 0.6637 | Acc: 0.6487
  Class 1 - P: 0.0018, R: 0.7615, F1: 0.0036
  Predicting class 1: 35.17617%
  Saved best model (F1: 0.0036)
Epoch  57 | Loss: 0.6633

Epoch  58 | Loss: 0.6653 | Acc: 0.6468
  Class 1 - P: 0.0018, R: 0.7675, F1: 0.0036
  Predicting class 1: 35.35984%
  Saved best model (F1: 0.0036)
Epoch  59 | Loss: 0.6652

Epoch  60 | Loss: 0.6622 | Acc: 0.6447
  Class 1 - P: 0.0018, R: 0.7746, F1: 0.0036
  Predicting class 1: 35.57697%
  Saved best model (F1: 0.0036)
Epoch  61 | Loss: 0.6638

Epoch  62 | Loss: 0.6643 | Acc: 0.6454
  Class 1 - P: 0.0018, R: 0.7754, F1: 0.0036
  Predicting class 1: 35.50443%
  Saved best model (F1: 0.0036)
Epoch  63 | Loss: 0.6591

Epoch  64 | Loss: 0.6671 | Acc: 0.6472
  Class 1 - P: 0.0018, R: 0.7766, F1: 0.0036
  Predicting class 1: 35.32465%
  Saved best model (F1: 0.0036)
Epoch  65 | Loss: 0.6580

Epoch  66 | Loss: 0.6591 | Acc: 0.6492
  Class 1 - P: 0.0018, R: 0.7778, F1: 0.0037
  Predicting class 1: 35.12470%
  Saved best model (F1: 0.0037)
Epoch  67 | Loss: 0.6573

Epoch  68 | Loss: 0.6584 | Acc: 0.6494
  Class 1 - P: 0.0019, R: 0.7811, F1: 0.0037
  Predicting class 1: 35.10944%
  Saved best model (F1: 0.0037)
Epoch  69 | Loss: 0.6573

Epoch  70 | Loss: 0.6550 | Acc: 0.6488
  Class 1 - P: 0.0019, R: 0.7837, F1: 0.0037
  Predicting class 1: 35.16564%
  Saved best model (F1: 0.0037)
Epoch  71 | Loss: 0.6542

Epoch  72 | Loss: 0.6562 | Acc: 0.6481
  Class 1 - P: 0.0019, R: 0.7882, F1: 0.0037
  Predicting class 1: 35.23923%
  Saved best model (F1: 0.0037)
Epoch  73 | Loss: 0.6486

Epoch  74 | Loss: 0.6516 | Acc: 0.6460
  Class 1 - P: 0.0019, R: 0.7938, F1: 0.0037
  Predicting class 1: 35.44929%
  Saved best model (F1: 0.0037)
Epoch  75 | Loss: 0.6523

Epoch  76 | Loss: 0.6526 | Acc: 0.6465
  Class 1 - P: 0.0019, R: 0.7959, F1: 0.0037
  Predicting class 1: 35.39561%
  Saved best model (F1: 0.0037)
Epoch  77 | Loss: 0.6487

Epoch  78 | Loss: 0.6502 | Acc: 0.6481
  Class 1 - P: 0.0019, R: 0.7979, F1: 0.0038
  Predicting class 1: 35.24209%
  Saved best model (F1: 0.0038)
Epoch  79 | Loss: 0.6470

Epoch  80 | Loss: 0.6474 | Acc: 0.6488
  Class 1 - P: 0.0019, R: 0.7988, F1: 0.0038
  Predicting class 1: 35.16702%
  Saved best model (F1: 0.0038)
Epoch  81 | Loss: 0.6423

Epoch  82 | Loss: 0.6443 | Acc: 0.6502
  Class 1 - P: 0.0019, R: 0.7988, F1: 0.0038
  Predicting class 1: 35.03329%
  Saved best model (F1: 0.0038)
Epoch  83 | Loss: 0.6438

Epoch  84 | Loss: 0.6428 | Acc: 0.6509
  Class 1 - P: 0.0019, R: 0.8024, F1: 0.0038
  Predicting class 1: 34.95720%
  Saved best model (F1: 0.0038)
Epoch  85 | Loss: 0.6474

Epoch  86 | Loss: 0.6422 | Acc: 0.6525
  Class 1 - P: 0.0019, R: 0.8050, F1: 0.0038
  Predicting class 1: 34.79881%
  Saved best model (F1: 0.0038)
Epoch  87 | Loss: 0.6432

Epoch  88 | Loss: 0.6475 | Acc: 0.6548
  Class 1 - P: 0.0019, R: 0.8065, F1: 0.0039
  Predicting class 1: 34.57150%
  Saved best model (F1: 0.0039)
Epoch  89 | Loss: 0.6399

Epoch  90 | Loss: 0.6460 | Acc: 0.6553
  Class 1 - P: 0.0020, R: 0.8098, F1: 0.0039
  Predicting class 1: 34.52259%
  Saved best model (F1: 0.0039)
Epoch  91 | Loss: 0.6441

Epoch  92 | Loss: 0.6349 | Acc: 0.6550
  Class 1 - P: 0.0020, R: 0.8101, F1: 0.0039
  Predicting class 1: 34.55350%
Epoch  93 | Loss: 0.6338

Epoch  94 | Loss: 0.6335 | Acc: 0.6545
  Class 1 - P: 0.0020, R: 0.8139, F1: 0.0039
  Predicting class 1: 34.60295%
  Saved best model (F1: 0.0039)
Epoch  95 | Loss: 0.6298

Epoch  96 | Loss: 0.6338 | Acc: 0.6515
  Class 1 - P: 0.0020, R: 0.8198, F1: 0.0039
  Predicting class 1: 34.90357%
Epoch  97 | Loss: 0.6295

Epoch  98 | Loss: 0.6318 | Acc: 0.6505
  Class 1 - P: 0.0020, R: 0.8216, F1: 0.0039
  Predicting class 1: 35.00424%
Epoch  99 | Loss: 0.6289

============================================================
TRAINING COMPLETE
============================================================
Class 0: 1013872 (99.82%)
Class 1: 1797 (0.18%)

============================================================
TEST SET RESULTS
============================================================
Overall Accuracy: 0.7109
AUC-ROC: 0.7766

Confusion Matrix:
  TN:  720682  FP:  293190
  FN:     477  TP:    1320

Class 0 (Legitimate):
  Precision: 0.9993
  Recall: 0.7108

Class 1 (Laundering):
  Precision: 0.0045
  Recall: 0.7346
  F1 Score: 0.0089
============================================================

============================================================
EVALUATION COMPLETE
============================================================
==========================================
Training completed successfully!
Output saved to: ./saved_models/
==========================================
Job completed at: Wed Nov 12 12:41:08 PM +08 2025
==========================================
