==========================================
Job ID: 283413
Job Name: dgl_gnn_train
Node: xgpi19
Start Time: Fri Nov 14 09:59:15 AM +08 2025
GPU Information:
Fri Nov 14 09:59:15 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 NVL                On  |   00000000:82:00.0 Off |                   On |
| N/A   40C    P0             62W /  400W |      87MiB /  95830MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  0    1   0   0  |              44MiB / 47488MiB    | 60      0 |  3   0    3    0    3 |
|                  |                 0MiB / 65535MiB  |           |                       |
+------------------+----------------------------------+-----------+-----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==========================================
Conda environment 'aml_project_new' already exists. Activating it...
Working directory: /home/l/linchieh/AML-GNN-project/classifier_src_soc
==========================================
Starting fine-tuning...
Output directory: ./saved_models/
Epochs: 100
Learning rate: 1e-4
==========================================
Preparing dataset
Warning: Looks like you're using an outdated `kagglehub` version, please consider updating (latest version: 0.3.13)
Path to dataset files: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8
Begin main loop
CUDA available: True
Loading HI-Small...


Loading transactions from: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8/HI-Small_Trans.csv
File size: 453.6 MB

Loaded 5,078,345 transactions
Date range: 2022-09-01 00:00:00 to 2022-09-18 16:18:00
Laundering transactions: 5,177 (0.102%)
============================================================
TEMPORAL TRAIN/TEST SPLIT
============================================================

Train Set:
  Date range: 2022-09-01 00:00:00 to 2022-09-08 16:12:00
  Transactions: 4,062,676
  Laundering: 3,380 (0.083%)

Test Set:
  Date range: 2022-09-08 16:12:00 to 2022-09-18 16:18:00
  Transactions: 1,015,669
  Laundering: 1,797 (0.177%)
============================================================
Number of nodes: 515080
Number of edges: 4062676
Number of nodes: 515080
Number of edges: 1015669
Class weights: tensor([  1., 800.], device='cuda:0')

============================================================
TRAINING
============================================================

Epoch   0 | Loss: 0.7131 | Acc: 0.2780
  Class 1 - P: 0.0009, R: 0.7601, F1: 0.0017
  Predicting class 1: 72.24029%
  Saved best model (F1: 0.0017)
Epoch   1 | Loss: 0.7134

Epoch   2 | Loss: 0.7058 | Acc: 0.4951
  Class 1 - P: 0.0010, R: 0.6349, F1: 0.0021
  Predicting class 1: 50.51363%
  Saved best model (F1: 0.0021)
Epoch   3 | Loss: 0.7140

Epoch   4 | Loss: 0.7007 | Acc: 0.6900
  Class 1 - P: 0.0014, R: 0.5044, F1: 0.0027
  Predicting class 1: 30.99974%
  Saved best model (F1: 0.0027)
Epoch   5 | Loss: 0.7111

Epoch   6 | Loss: 0.6912 | Acc: 0.8109
  Class 1 - P: 0.0018, R: 0.4015, F1: 0.0035
  Predicting class 1: 18.88903%
  Saved best model (F1: 0.0035)
Epoch   7 | Loss: 0.6917

Epoch   8 | Loss: 0.6887 | Acc: 0.8632
  Class 1 - P: 0.0019, R: 0.3107, F1: 0.0038
  Predicting class 1: 13.65189%
  Saved best model (F1: 0.0038)
Epoch   9 | Loss: 0.6928

Epoch  10 | Loss: 0.6872 | Acc: 0.8901
  Class 1 - P: 0.0018, R: 0.2393, F1: 0.0036
  Predicting class 1: 10.94867%
Epoch  11 | Loss: 0.6855

Epoch  12 | Loss: 0.6787 | Acc: 0.9044
  Class 1 - P: 0.0017, R: 0.1923, F1: 0.0033
  Predicting class 1: 9.50516%
Epoch  13 | Loss: 0.6791

Epoch  14 | Loss: 0.6772 | Acc: 0.9136
  Class 1 - P: 0.0016, R: 0.1675, F1: 0.0032
  Predicting class 1: 8.58286%
Epoch  15 | Loss: 0.6758

Epoch  16 | Loss: 0.6801 | Acc: 0.9207
  Class 1 - P: 0.0016, R: 0.1512, F1: 0.0032
  Predicting class 1: 7.87442%
Epoch  17 | Loss: 0.6803

Epoch  18 | Loss: 0.6746 | Acc: 0.9264
  Class 1 - P: 0.0016, R: 0.1399, F1: 0.0032
  Predicting class 1: 7.29682%
Epoch  19 | Loss: 0.6720

Epoch  20 | Loss: 0.6738 | Acc: 0.9301
  Class 1 - P: 0.0016, R: 0.1334, F1: 0.0032
  Predicting class 1: 6.92425%
Epoch  21 | Loss: 0.6747

Epoch  22 | Loss: 0.6727 | Acc: 0.9324
  Class 1 - P: 0.0016, R: 0.1284, F1: 0.0032
  Predicting class 1: 6.69716%
Epoch  23 | Loss: 0.6759

Epoch  24 | Loss: 0.6713 | Acc: 0.9329
  Class 1 - P: 0.0016, R: 0.1278, F1: 0.0032
  Predicting class 1: 6.64791%
Epoch  25 | Loss: 0.6731

Epoch  26 | Loss: 0.6689 | Acc: 0.9317
  Class 1 - P: 0.0016, R: 0.1305, F1: 0.0032
  Predicting class 1: 6.76938%
Epoch  27 | Loss: 0.6656

Epoch  28 | Loss: 0.6682 | Acc: 0.9297
  Class 1 - P: 0.0016, R: 0.1355, F1: 0.0032
  Predicting class 1: 6.96876%
Epoch  29 | Loss: 0.6663

Epoch  30 | Loss: 0.6668 | Acc: 0.9269
  Class 1 - P: 0.0016, R: 0.1432, F1: 0.0032
  Predicting class 1: 7.25349%
Epoch  31 | Loss: 0.6652

Epoch  32 | Loss: 0.6663 | Acc: 0.9235
  Class 1 - P: 0.0017, R: 0.1521, F1: 0.0033
  Predicting class 1: 7.59091%
Epoch  33 | Loss: 0.6676

Epoch  34 | Loss: 0.6584 | Acc: 0.9197
  Class 1 - P: 0.0017, R: 0.1648, F1: 0.0034
  Predicting class 1: 7.96982%
Epoch  35 | Loss: 0.6637

Epoch  36 | Loss: 0.6679 | Acc: 0.9159
  Class 1 - P: 0.0018, R: 0.1787, F1: 0.0035
  Predicting class 1: 8.36119%
Epoch  37 | Loss: 0.6605

Epoch  38 | Loss: 0.6611 | Acc: 0.9121
  Class 1 - P: 0.0018, R: 0.1932, F1: 0.0036
  Predicting class 1: 8.74190%
Epoch  39 | Loss: 0.6613

Epoch  40 | Loss: 0.6596 | Acc: 0.9074
  Class 1 - P: 0.0019, R: 0.2101, F1: 0.0038
  Predicting class 1: 9.21198%
Epoch  41 | Loss: 0.6547

Epoch  42 | Loss: 0.6577 | Acc: 0.9020
  Class 1 - P: 0.0019, R: 0.2281, F1: 0.0039
  Predicting class 1: 9.75835%
  Saved best model (F1: 0.0039)
Epoch  43 | Loss: 0.6538

Epoch  44 | Loss: 0.6564 | Acc: 0.8971
  Class 1 - P: 0.0020, R: 0.2479, F1: 0.0040
  Predicting class 1: 10.25048%
  Saved best model (F1: 0.0040)
Epoch  45 | Loss: 0.6563

Epoch  46 | Loss: 0.6598 | Acc: 0.8927
  Class 1 - P: 0.0020, R: 0.2630, F1: 0.0041
  Predicting class 1: 10.68832%
  Saved best model (F1: 0.0041)
Epoch  47 | Loss: 0.6535

Epoch  48 | Loss: 0.6536 | Acc: 0.8886
  Class 1 - P: 0.0021, R: 0.2828, F1: 0.0042
  Predicting class 1: 11.10022%
  Saved best model (F1: 0.0042)
Epoch  49 | Loss: 0.6534

Epoch  50 | Loss: 0.6530 | Acc: 0.8859
  Class 1 - P: 0.0022, R: 0.2970, F1: 0.0043
  Predicting class 1: 11.37637%
  Saved best model (F1: 0.0043)
Epoch  51 | Loss: 0.6498

Epoch  52 | Loss: 0.6504 | Acc: 0.8832
  Class 1 - P: 0.0022, R: 0.3098, F1: 0.0044
  Predicting class 1: 11.65173%
  Saved best model (F1: 0.0044)
Epoch  53 | Loss: 0.6457

Epoch  54 | Loss: 0.6515 | Acc: 0.8809
  Class 1 - P: 0.0023, R: 0.3219, F1: 0.0045
  Predicting class 1: 11.88044%
  Saved best model (F1: 0.0045)
Epoch  55 | Loss: 0.6495

Epoch  56 | Loss: 0.6484 | Acc: 0.8784
  Class 1 - P: 0.0023, R: 0.3311, F1: 0.0045
  Predicting class 1: 12.12698%
  Saved best model (F1: 0.0045)
Epoch  57 | Loss: 0.6453

Epoch  58 | Loss: 0.6443 | Acc: 0.8761
  Class 1 - P: 0.0023, R: 0.3423, F1: 0.0046
  Predicting class 1: 12.35956%
  Saved best model (F1: 0.0046)
Epoch  59 | Loss: 0.6455

Epoch  60 | Loss: 0.6453 | Acc: 0.8745
  Class 1 - P: 0.0023, R: 0.3527, F1: 0.0047
  Predicting class 1: 12.52723%
  Saved best model (F1: 0.0047)
Epoch  61 | Loss: 0.6437

Epoch  62 | Loss: 0.6429 | Acc: 0.8732
  Class 1 - P: 0.0024, R: 0.3636, F1: 0.0047
  Predicting class 1: 12.66156%
  Saved best model (F1: 0.0047)
Epoch  63 | Loss: 0.6441

Epoch  64 | Loss: 0.6412 | Acc: 0.8713
  Class 1 - P: 0.0024, R: 0.3763, F1: 0.0048
  Predicting class 1: 12.84722%
  Saved best model (F1: 0.0048)
Epoch  65 | Loss: 0.6421

Epoch  66 | Loss: 0.6425 | Acc: 0.8694
  Class 1 - P: 0.0025, R: 0.3917, F1: 0.0050
  Predicting class 1: 13.03847%
  Saved best model (F1: 0.0050)
Epoch  67 | Loss: 0.6402

Epoch  68 | Loss: 0.6396 | Acc: 0.8673
  Class 1 - P: 0.0025, R: 0.4059, F1: 0.0051
  Predicting class 1: 13.25373%
  Saved best model (F1: 0.0051)
Epoch  69 | Loss: 0.6375

Epoch  70 | Loss: 0.6347 | Acc: 0.8647
  Class 1 - P: 0.0026, R: 0.4213, F1: 0.0052
  Predicting class 1: 13.51533%
  Saved best model (F1: 0.0052)
Epoch  71 | Loss: 0.6349

Epoch  72 | Loss: 0.6342 | Acc: 0.8626
  Class 1 - P: 0.0026, R: 0.4355, F1: 0.0052
  Predicting class 1: 13.73346%
  Saved best model (F1: 0.0052)
Epoch  73 | Loss: 0.6348

Epoch  74 | Loss: 0.6328 | Acc: 0.8605
  Class 1 - P: 0.0027, R: 0.4506, F1: 0.0053
  Predicting class 1: 13.94047%
  Saved best model (F1: 0.0053)
Epoch  75 | Loss: 0.6298

Epoch  76 | Loss: 0.6303 | Acc: 0.8579
  Class 1 - P: 0.0027, R: 0.4657, F1: 0.0054
  Predicting class 1: 14.20778%
  Saved best model (F1: 0.0054)
Epoch  77 | Loss: 0.6285

Epoch  78 | Loss: 0.6302 | Acc: 0.8553
  Class 1 - P: 0.0028, R: 0.4802, F1: 0.0055
  Predicting class 1: 14.47123%
  Saved best model (F1: 0.0055)
Epoch  79 | Loss: 0.6278

Epoch  80 | Loss: 0.6247 | Acc: 0.8529
  Class 1 - P: 0.0028, R: 0.4938, F1: 0.0056
  Predicting class 1: 14.71247%
  Saved best model (F1: 0.0056)
Epoch  81 | Loss: 0.6282

Epoch  82 | Loss: 0.6232 | Acc: 0.8499
  Class 1 - P: 0.0028, R: 0.5080, F1: 0.0056
  Predicting class 1: 15.00929%
  Saved best model (F1: 0.0056)
Epoch  83 | Loss: 0.6231

Epoch  84 | Loss: 0.6242 | Acc: 0.8472
  Class 1 - P: 0.0028, R: 0.5213, F1: 0.0056
  Predicting class 1: 15.28677%
  Saved best model (F1: 0.0056)
Epoch  85 | Loss: 0.6241

Epoch  86 | Loss: 0.6231 | Acc: 0.8436
  Class 1 - P: 0.0029, R: 0.5376, F1: 0.0057
  Predicting class 1: 15.64634%
  Saved best model (F1: 0.0057)
Epoch  87 | Loss: 0.6221

Epoch  88 | Loss: 0.6213 | Acc: 0.8403
  Class 1 - P: 0.0029, R: 0.5509, F1: 0.0057
  Predicting class 1: 15.97504%
  Saved best model (F1: 0.0057)
Epoch  89 | Loss: 0.6201

Epoch  90 | Loss: 0.6141 | Acc: 0.8382
  Class 1 - P: 0.0029, R: 0.5601, F1: 0.0057
  Predicting class 1: 16.18714%
  Saved best model (F1: 0.0057)
Epoch  91 | Loss: 0.6173

Epoch  92 | Loss: 0.6168 | Acc: 0.8376
  Class 1 - P: 0.0029, R: 0.5680, F1: 0.0058
  Predicting class 1: 16.24867%
  Saved best model (F1: 0.0058)
Epoch  93 | Loss: 0.6143

Epoch  94 | Loss: 0.6170 | Acc: 0.8362
  Class 1 - P: 0.0029, R: 0.5749, F1: 0.0058
  Predicting class 1: 16.39742%
  Saved best model (F1: 0.0058)
Epoch  95 | Loss: 0.6100

Epoch  96 | Loss: 0.6137 | Acc: 0.8345
  Class 1 - P: 0.0029, R: 0.5828, F1: 0.0058
  Predicting class 1: 16.55997%
  Saved best model (F1: 0.0058)
Epoch  97 | Loss: 0.6097

Epoch  98 | Loss: 0.6119 | Acc: 0.8336
  Class 1 - P: 0.0029, R: 0.5891, F1: 0.0059
  Predicting class 1: 16.65616%
  Saved best model (F1: 0.0059)
Epoch  99 | Loss: 0.6081

============================================================
TRAINING COMPLETE
============================================================
Class 0: 1013872 (99.82%)
Class 1: 1797 (0.18%)

============================================================
TEST SET RESULTS
============================================================
Overall Accuracy: 0.8763
AUC-ROC: 0.7369

Confusion Matrix:
  TN:  889285  FP:  124587
  FN:    1013  TP:     784

Class 0 (Legitimate):
  Precision: 0.9989
  Recall: 0.8771

Class 1 (Laundering):
  Precision: 0.0063
  Recall: 0.4363
  F1 Score: 0.0123
============================================================

============================================================
EVALUATION COMPLETE
============================================================
==========================================
Training completed successfully!
Output saved to: ./saved_models/
==========================================
Job completed at: Fri Nov 14 10:02:45 AM +08 2025
==========================================
