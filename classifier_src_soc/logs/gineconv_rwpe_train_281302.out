==========================================
Job ID: 281302
Job Name: train_gineconv_rwpe
Node: xgpi17
Start Time: Thu Nov 13 09:04:55 AM +08 2025
GPU Information:
Thu Nov 13 09:04:55 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 NVL                On  |   00000000:E3:00.0 Off |                   On |
| N/A   62C    P0             74W /  400W |      87MiB /  95830MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  0    1   0   0  |              44MiB / 47488MiB    | 60      0 |  3   0    3    0    3 |
|                  |                 0MiB / 65535MiB  |           |                       |
+------------------+----------------------------------+-----------+-----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==========================================
Conda environment 'aml_project_new' already exists. Activating it...
Working directory: /home/l/linchieh/AML-GNN-project/classifier_src_soc
==========================================
Starting fine-tuning...
Output directory: ./saved_models/
Epochs: 100
Learning rate: 1e-4
==========================================
Warning: Looks like you're using an outdated `kagglehub` version, please consider updating (latest version: 0.3.13)
Path to dataset files: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8
Loading HI-Small...


Loading transactions from: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8/HI-Small_Trans.csv
File size: 453.6 MB

Loaded 5,078,345 transactions
Date range: 2022-09-01 00:00:00 to 2022-09-18 16:18:00
Laundering transactions: 5,177 (0.102%)
============================================================
TEMPORAL TRAIN/TEST SPLIT
============================================================

Train Set:
  Date range: 2022-09-01 00:00:00 to 2022-09-08 16:12:00
  Transactions: 4,062,676
  Laundering: 3,380 (0.083%)

Test Set:
  Date range: 2022-09-08 16:12:00 to 2022-09-18 16:18:00
  Transactions: 1,015,669
  Laundering: 1,797 (0.177%)
============================================================
Number of nodes: 515080
Number of edges: 4062676
Adding RWPE feats
cpu
soc_gineconvnet_rwpe.py:96: UserWarning: Sparse CSR tensor support is in beta state. If you miss a functionality in the sparse tensor support, please submit a feature request to https://github.com/pytorch/pytorch/issues. (Triggered internally at /opt/conda/conda-bld/pytorch_1702400400184/work/aten/src/ATen/SparseCsrTensorImpl.cpp:53.)
  P = torch.sparse.mm(D_inv, A)
Added RWPE feats
Number of nodes: 515080
Number of edges: 1015669
Adding RWPE feats
cpu
Added RWPE feats
Class weights: tensor([  1., 100.], device='cuda:0')

============================================================
TRAINING
============================================================

Epoch   0 | Loss: 2.1419 | Acc: 0.2009
  Class 1 - P: 0.0008, R: 0.7222, F1: 0.0015
  Predicting class 1: 79.94981%
  Saved best model (F1: 0.0015)

Epoch   1 | Loss: 1.8275 | Acc: 0.3157
  Class 1 - P: 0.0008, R: 0.6379, F1: 0.0015
  Predicting class 1: 68.45695%
  Saved best model (F1: 0.0015)

Epoch   2 | Loss: 1.5339 | Acc: 0.4629
  Class 1 - P: 0.0009, R: 0.5580, F1: 0.0017
  Predicting class 1: 53.72139%
  Saved best model (F1: 0.0017)

Epoch   3 | Loss: 1.5912 | Acc: 0.5535
  Class 1 - P: 0.0009, R: 0.4985, F1: 0.0019
  Predicting class 1: 44.65436%
  Saved best model (F1: 0.0019)

Epoch   4 | Loss: 1.4004 | Acc: 0.6268
  Class 1 - P: 0.0010, R: 0.4485, F1: 0.0020
  Predicting class 1: 37.31619%
  Saved best model (F1: 0.0020)

Epoch   5 | Loss: 1.2231 | Acc: 0.6864
  Class 1 - P: 0.0010, R: 0.3879, F1: 0.0021
  Predicting class 1: 31.34350%
  Saved best model (F1: 0.0021)

Epoch   6 | Loss: 1.2014 | Acc: 0.7417
  Class 1 - P: 0.0011, R: 0.3346, F1: 0.0022
  Predicting class 1: 25.80065%
  Saved best model (F1: 0.0022)

Epoch   7 | Loss: 1.1915 | Acc: 0.7903
  Class 1 - P: 0.0011, R: 0.2781, F1: 0.0022
  Predicting class 1: 20.93411%
  Saved best model (F1: 0.0022)

Epoch   8 | Loss: 1.0808 | Acc: 0.8327
  Class 1 - P: 0.0011, R: 0.2302, F1: 0.0023
  Predicting class 1: 16.68942%
  Saved best model (F1: 0.0023)

Epoch   9 | Loss: 1.0846 | Acc: 0.8644
  Class 1 - P: 0.0012, R: 0.1905, F1: 0.0023
  Predicting class 1: 13.50693%
  Saved best model (F1: 0.0023)

Epoch  10 | Loss: 1.0999 | Acc: 0.8910
  Class 1 - P: 0.0012, R: 0.1607, F1: 0.0024
  Predicting class 1: 10.84736%
  Saved best model (F1: 0.0024)

Epoch  11 | Loss: 1.0460 | Acc: 0.9100
  Class 1 - P: 0.0013, R: 0.1393, F1: 0.0026
  Predicting class 1: 8.94226%
  Saved best model (F1: 0.0026)

Epoch  12 | Loss: 0.9780 | Acc: 0.9245
  Class 1 - P: 0.0013, R: 0.1180, F1: 0.0026
  Predicting class 1: 7.48467%
  Saved best model (F1: 0.0026)

Epoch  13 | Loss: 1.0156 | Acc: 0.9358
  Class 1 - P: 0.0013, R: 0.1027, F1: 0.0027
  Predicting class 1: 6.35453%
  Saved best model (F1: 0.0027)

Epoch  14 | Loss: 0.9510 | Acc: 0.9555
  Class 1 - P: 0.0013, R: 0.0701, F1: 0.0026
  Predicting class 1: 4.37714%

Epoch  15 | Loss: 0.9555 | Acc: 0.9731
  Class 1 - P: 0.0014, R: 0.0447, F1: 0.0028
  Predicting class 1: 2.61815%
  Saved best model (F1: 0.0028)

Epoch  16 | Loss: 0.9270 | Acc: 0.9804
  Class 1 - P: 0.0017, R: 0.0382, F1: 0.0032
  Predicting class 1: 1.88583%
  Saved best model (F1: 0.0032)

Epoch  17 | Loss: 0.9573 | Acc: 0.9840
  Class 1 - P: 0.0019, R: 0.0340, F1: 0.0035
  Predicting class 1: 1.52631%
  Saved best model (F1: 0.0035)

Epoch  18 | Loss: 0.9229 | Acc: 0.9861
  Class 1 - P: 0.0021, R: 0.0334, F1: 0.0040
  Predicting class 1: 1.31610%
  Saved best model (F1: 0.0040)

Epoch  19 | Loss: 0.9169 | Acc: 0.9878
  Class 1 - P: 0.0023, R: 0.0314, F1: 0.0042
  Predicting class 1: 1.14678%
  Saved best model (F1: 0.0042)

Epoch  20 | Loss: 0.8581 | Acc: 0.9889
  Class 1 - P: 0.0023, R: 0.0290, F1: 0.0043
  Predicting class 1: 1.03420%
  Saved best model (F1: 0.0043)

Epoch  21 | Loss: 0.8412 | Acc: 0.9896
  Class 1 - P: 0.0025, R: 0.0290, F1: 0.0046
  Predicting class 1: 0.96412%
  Saved best model (F1: 0.0046)

Epoch  22 | Loss: 0.8548 | Acc: 0.9899
  Class 1 - P: 0.0027, R: 0.0299, F1: 0.0049
  Predicting class 1: 0.92926%
  Saved best model (F1: 0.0049)

Epoch  23 | Loss: 0.8776 | Acc: 0.9900
  Class 1 - P: 0.0028, R: 0.0308, F1: 0.0051
  Predicting class 1: 0.92407%
  Saved best model (F1: 0.0051)

Epoch  24 | Loss: 0.8923 | Acc: 0.9899
  Class 1 - P: 0.0030, R: 0.0340, F1: 0.0056
  Predicting class 1: 0.93165%
  Saved best model (F1: 0.0056)

Epoch  25 | Loss: 0.8348 | Acc: 0.9897
  Class 1 - P: 0.0034, R: 0.0391, F1: 0.0062
  Predicting class 1: 0.95779%
  Saved best model (F1: 0.0062)

Epoch  26 | Loss: 0.8220 | Acc: 0.9890
  Class 1 - P: 0.0035, R: 0.0426, F1: 0.0064
  Predicting class 1: 1.02600%
  Saved best model (F1: 0.0064)

Epoch  27 | Loss: 0.8229 | Acc: 0.9879
  Class 1 - P: 0.0035, R: 0.0479, F1: 0.0065
  Predicting class 1: 1.13758%
  Saved best model (F1: 0.0065)

Epoch  28 | Loss: 0.7932 | Acc: 0.9873
  Class 1 - P: 0.0038, R: 0.0544, F1: 0.0071
  Predicting class 1: 1.19736%
  Saved best model (F1: 0.0071)

Epoch  29 | Loss: 0.7892 | Acc: 0.9867
  Class 1 - P: 0.0040, R: 0.0609, F1: 0.0075
  Predicting class 1: 1.26089%
  Saved best model (F1: 0.0075)

Epoch  30 | Loss: 0.8249 | Acc: 0.9859
  Class 1 - P: 0.0040, R: 0.0633, F1: 0.0074
  Predicting class 1: 1.33331%

Epoch  31 | Loss: 0.8375 | Acc: 0.9850
  Class 1 - P: 0.0041, R: 0.0695, F1: 0.0077
  Predicting class 1: 1.42495%
  Saved best model (F1: 0.0077)

Epoch  32 | Loss: 0.7821 | Acc: 0.9842
  Class 1 - P: 0.0039, R: 0.0716, F1: 0.0075
  Predicting class 1: 1.51253%

Epoch  33 | Loss: 0.7932 | Acc: 0.9834
  Class 1 - P: 0.0040, R: 0.0772, F1: 0.0077
  Predicting class 1: 1.59188%

Epoch  34 | Loss: 0.7685 | Acc: 0.9826
  Class 1 - P: 0.0040, R: 0.0802, F1: 0.0076
  Predicting class 1: 1.66814%

Epoch  35 | Loss: 0.7847 | Acc: 0.9821
  Class 1 - P: 0.0040, R: 0.0831, F1: 0.0077
  Predicting class 1: 1.72108%

Epoch  36 | Loss: 0.7766 | Acc: 0.9817
  Class 1 - P: 0.0040, R: 0.0849, F1: 0.0077
  Predicting class 1: 1.75845%
  Saved best model (F1: 0.0077)

Epoch  37 | Loss: 0.7734 | Acc: 0.9814
  Class 1 - P: 0.0040, R: 0.0852, F1: 0.0076
  Predicting class 1: 1.78658%

Epoch  38 | Loss: 0.7580 | Acc: 0.9812
  Class 1 - P: 0.0039, R: 0.0852, F1: 0.0075
  Predicting class 1: 1.80770%

Epoch  39 | Loss: 0.7725 | Acc: 0.9809
  Class 1 - P: 0.0039, R: 0.0855, F1: 0.0074
  Predicting class 1: 1.84494%

Epoch  40 | Loss: 0.7625 | Acc: 0.9808
  Class 1 - P: 0.0039, R: 0.0864, F1: 0.0075
  Predicting class 1: 1.84622%

Epoch  41 | Loss: 0.7560 | Acc: 0.9811
  Class 1 - P: 0.0039, R: 0.0849, F1: 0.0074
  Predicting class 1: 1.82523%

Epoch  42 | Loss: 0.7621 | Acc: 0.9813
  Class 1 - P: 0.0038, R: 0.0834, F1: 0.0074
  Predicting class 1: 1.80541%

Epoch  43 | Loss: 0.7469 | Acc: 0.9815
  Class 1 - P: 0.0038, R: 0.0817, F1: 0.0073
  Predicting class 1: 1.78311%

Epoch  44 | Loss: 0.7508 | Acc: 0.9818
  Class 1 - P: 0.0037, R: 0.0781, F1: 0.0071
  Predicting class 1: 1.75143%

Epoch  45 | Loss: 0.7168 | Acc: 0.9821
  Class 1 - P: 0.0036, R: 0.0740, F1: 0.0068
  Predicting class 1: 1.71938%

Epoch  46 | Loss: 0.7210 | Acc: 0.9824
  Class 1 - P: 0.0033, R: 0.0678, F1: 0.0064
  Predicting class 1: 1.68652%

Epoch  47 | Loss: 0.7482 | Acc: 0.9828
  Class 1 - P: 0.0033, R: 0.0654, F1: 0.0063
  Predicting class 1: 1.64542%

Epoch  48 | Loss: 0.7396 | Acc: 0.9831
  Class 1 - P: 0.0033, R: 0.0645, F1: 0.0063
  Predicting class 1: 1.61940%

Epoch  49 | Loss: 0.7530 | Acc: 0.9831
  Class 1 - P: 0.0032, R: 0.0633, F1: 0.0062
  Predicting class 1: 1.62152%

Epoch  50 | Loss: 0.7194 | Acc: 0.9827
  Class 1 - P: 0.0031, R: 0.0624, F1: 0.0060
  Predicting class 1: 1.65307%

Epoch  51 | Loss: 0.7196 | Acc: 0.9822
  Class 1 - P: 0.0030, R: 0.0624, F1: 0.0058
  Predicting class 1: 1.70457%

Epoch  52 | Loss: 0.7267 | Acc: 0.9817
  Class 1 - P: 0.0030, R: 0.0630, F1: 0.0057
  Predicting class 1: 1.75776%

Epoch  53 | Loss: 0.7257 | Acc: 0.9804
  Class 1 - P: 0.0028, R: 0.0642, F1: 0.0054
  Predicting class 1: 1.88834%

Epoch  54 | Loss: 0.7425 | Acc: 0.9774
  Class 1 - P: 0.0026, R: 0.0686, F1: 0.0050
  Predicting class 1: 2.18548%

Epoch  55 | Loss: 0.7295 | Acc: 0.9727
  Class 1 - P: 0.0023, R: 0.0751, F1: 0.0046
  Predicting class 1: 2.66179%

Epoch  56 | Loss: 0.7098 | Acc: 0.9683
  Class 1 - P: 0.0022, R: 0.0834, F1: 0.0044
  Predicting class 1: 3.09614%

Epoch  57 | Loss: 0.7133 | Acc: 0.9663
  Class 1 - P: 0.0022, R: 0.0885, F1: 0.0044
  Predicting class 1: 3.30053%

Epoch  58 | Loss: 0.7340 | Acc: 0.9643
  Class 1 - P: 0.0022, R: 0.0917, F1: 0.0043
  Predicting class 1: 3.49801%

Epoch  59 | Loss: 0.7086 | Acc: 0.9632
  Class 1 - P: 0.0022, R: 0.0947, F1: 0.0043
  Predicting class 1: 3.60907%

Epoch  60 | Loss: 0.7121 | Acc: 0.9630
  Class 1 - P: 0.0022, R: 0.0950, F1: 0.0043
  Predicting class 1: 3.63041%

Epoch  61 | Loss: 0.7124 | Acc: 0.9633
  Class 1 - P: 0.0022, R: 0.0962, F1: 0.0043
  Predicting class 1: 3.60531%

Epoch  62 | Loss: 0.6937 | Acc: 0.9633
  Class 1 - P: 0.0022, R: 0.0970, F1: 0.0044
  Predicting class 1: 3.59906%

Epoch  63 | Loss: 0.7046 | Acc: 0.9634
  Class 1 - P: 0.0023, R: 0.0976, F1: 0.0044
  Predicting class 1: 3.59728%

Epoch  64 | Loss: 0.7134 | Acc: 0.9635
  Class 1 - P: 0.0022, R: 0.0959, F1: 0.0044
  Predicting class 1: 3.58037%

Epoch  65 | Loss: 0.7029 | Acc: 0.9631
  Class 1 - P: 0.0023, R: 0.1009, F1: 0.0045
  Predicting class 1: 3.62699%

Epoch  66 | Loss: 0.6932 | Acc: 0.9624
  Class 1 - P: 0.0023, R: 0.1036, F1: 0.0046
  Predicting class 1: 3.69412%

Epoch  67 | Loss: 0.7112 | Acc: 0.9613
  Class 1 - P: 0.0024, R: 0.1089, F1: 0.0047
  Predicting class 1: 3.80276%

Epoch  68 | Loss: 0.7112 | Acc: 0.9596
  Class 1 - P: 0.0024, R: 0.1148, F1: 0.0047
  Predicting class 1: 3.97733%

Epoch  69 | Loss: 0.6962 | Acc: 0.9583
  Class 1 - P: 0.0024, R: 0.1189, F1: 0.0047
  Predicting class 1: 4.10621%

Epoch  70 | Loss: 0.6899 | Acc: 0.9578
  Class 1 - P: 0.0024, R: 0.1216, F1: 0.0048
  Predicting class 1: 4.16051%

Epoch  71 | Loss: 0.6901 | Acc: 0.9575
  Class 1 - P: 0.0025, R: 0.1237, F1: 0.0048
  Predicting class 1: 4.18569%

Epoch  72 | Loss: 0.6845 | Acc: 0.9576
  Class 1 - P: 0.0025, R: 0.1246, F1: 0.0049
  Predicting class 1: 4.18086%

Epoch  73 | Loss: 0.6841 | Acc: 0.9581
  Class 1 - P: 0.0025, R: 0.1234, F1: 0.0049
  Predicting class 1: 4.13196%

Epoch  74 | Loss: 0.7007 | Acc: 0.9585
  Class 1 - P: 0.0025, R: 0.1251, F1: 0.0050
  Predicting class 1: 4.08548%

Epoch  75 | Loss: 0.6754 | Acc: 0.9588
  Class 1 - P: 0.0026, R: 0.1260, F1: 0.0051
  Predicting class 1: 4.05432%

Epoch  76 | Loss: 0.6769 | Acc: 0.9589
  Class 1 - P: 0.0026, R: 0.1284, F1: 0.0052
  Predicting class 1: 4.04462%

Epoch  77 | Loss: 0.6779 | Acc: 0.9592
  Class 1 - P: 0.0027, R: 0.1287, F1: 0.0052
  Predicting class 1: 4.01531%

Epoch  78 | Loss: 0.6777 | Acc: 0.9595
  Class 1 - P: 0.0027, R: 0.1281, F1: 0.0052
  Predicting class 1: 3.98656%

Epoch  79 | Loss: 0.6783 | Acc: 0.9594
  Class 1 - P: 0.0027, R: 0.1302, F1: 0.0053
  Predicting class 1: 3.99616%

Epoch  80 | Loss: 0.6798 | Acc: 0.9595
  Class 1 - P: 0.0027, R: 0.1314, F1: 0.0054
  Predicting class 1: 3.98988%

Epoch  81 | Loss: 0.6736 | Acc: 0.9605
  Class 1 - P: 0.0028, R: 0.1296, F1: 0.0054
  Predicting class 1: 3.89273%

Epoch  82 | Loss: 0.6853 | Acc: 0.9613
  Class 1 - P: 0.0028, R: 0.1302, F1: 0.0056
  Predicting class 1: 3.80739%

Epoch  83 | Loss: 0.6838 | Acc: 0.9617
  Class 1 - P: 0.0029, R: 0.1299, F1: 0.0056
  Predicting class 1: 3.77182%

Epoch  84 | Loss: 0.6802 | Acc: 0.9617
  Class 1 - P: 0.0029, R: 0.1296, F1: 0.0056
  Predicting class 1: 3.76493%

Epoch  85 | Loss: 0.6911 | Acc: 0.9612
  Class 1 - P: 0.0029, R: 0.1317, F1: 0.0056
  Predicting class 1: 3.81643%

Epoch  86 | Loss: 0.6706 | Acc: 0.9617
  Class 1 - P: 0.0029, R: 0.1331, F1: 0.0058
  Predicting class 1: 3.76722%

Epoch  87 | Loss: 0.6829 | Acc: 0.9632
  Class 1 - P: 0.0031, R: 0.1328, F1: 0.0060
  Predicting class 1: 3.61870%

Epoch  88 | Loss: 0.6727 | Acc: 0.9640
  Class 1 - P: 0.0031, R: 0.1299, F1: 0.0060
  Predicting class 1: 3.53964%

Epoch  89 | Loss: 0.6798 | Acc: 0.9639
  Class 1 - P: 0.0030, R: 0.1290, F1: 0.0059
  Predicting class 1: 3.54874%

Epoch  90 | Loss: 0.6736 | Acc: 0.9635
  Class 1 - P: 0.0030, R: 0.1302, F1: 0.0059
  Predicting class 1: 3.58517%

Epoch  91 | Loss: 0.6731 | Acc: 0.9636
  Class 1 - P: 0.0030, R: 0.1305, F1: 0.0059
  Predicting class 1: 3.57986%

Epoch  92 | Loss: 0.6814 | Acc: 0.9652
  Class 1 - P: 0.0031, R: 0.1266, F1: 0.0060
  Predicting class 1: 3.42188%

Epoch  93 | Loss: 0.6599 | Acc: 0.9669
  Class 1 - P: 0.0031, R: 0.1225, F1: 0.0061
  Predicting class 1: 3.24877%

Epoch  94 | Loss: 0.6555 | Acc: 0.9703
  Class 1 - P: 0.0033, R: 0.1154, F1: 0.0064
  Predicting class 1: 2.90358%

Epoch  95 | Loss: 0.6733 | Acc: 0.9714
  Class 1 - P: 0.0034, R: 0.1145, F1: 0.0066
  Predicting class 1: 2.79400%

Epoch  96 | Loss: 0.6584 | Acc: 0.9722
  Class 1 - P: 0.0035, R: 0.1133, F1: 0.0067
  Predicting class 1: 2.71321%

Epoch  97 | Loss: 0.6631 | Acc: 0.9740
  Class 1 - P: 0.0036, R: 0.1109, F1: 0.0070
  Predicting class 1: 2.53803%

Epoch  98 | Loss: 0.6738 | Acc: 0.9746
  Class 1 - P: 0.0038, R: 0.1118, F1: 0.0073
  Predicting class 1: 2.47504%

Epoch  99 | Loss: 0.6768 | Acc: 0.9761
  Class 1 - P: 0.0039, R: 0.1095, F1: 0.0076
  Predicting class 1: 2.32874%

============================================================
TRAINING COMPLETE
============================================================
Class 0: 1013872 (99.82%)
Class 1: 1797 (0.18%)

============================================================
TEST SET RESULTS
============================================================
Overall Accuracy: 0.9756
AUC-ROC: 0.5884

Confusion Matrix:
  TN:  990597  FP:   23275
  FN:    1468  TP:     329

Class 0 (Legitimate):
  Precision: 0.9985
  Recall: 0.9770

Class 1 (Laundering):
  Precision: 0.0139
  Recall: 0.1831
  F1 Score: 0.0259
============================================================

============================================================
EVALUATION COMPLETE
============================================================
==========================================
Training completed successfully!
Output saved to: ./saved_models/
==========================================
Job completed at: Thu Nov 13 09:07:33 AM +08 2025
==========================================
