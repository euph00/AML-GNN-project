==========================================
Job ID: 283584
Job Name: dgl_gnn_train
Node: xgpi2
Start Time: Fri Nov 14 11:10:51 AM +08 2025
GPU Information:
Fri Nov 14 11:10:51 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 NVL                On  |   00000000:E3:00.0 Off |                    0 |
| N/A   33C    P0             65W /  400W |       0MiB /  95830MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==========================================
Conda environment 'aml_project_new' already exists. Activating it...
Working directory: /home/l/linchieh/AML-GNN-project/classifier_src_soc
==========================================
Starting fine-tuning...
Output directory: ./saved_models/
Epochs: 100
Learning rate: 1e-4
==========================================
Preparing dataset
Warning: Looks like you're using an outdated `kagglehub` version, please consider updating (latest version: 0.3.13)
Path to dataset files: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8
Begin main loop
CUDA available: True
Loading HI-Small...


Loading transactions from: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8/HI-Small_Trans.csv
File size: 453.6 MB

Loaded 5,078,345 transactions
Date range: 2022-09-01 00:00:00 to 2022-09-18 16:18:00
Laundering transactions: 5,177 (0.102%)
============================================================
TEMPORAL TRAIN/TEST SPLIT
============================================================

Train Set:
  Date range: 2022-09-01 00:00:00 to 2022-09-08 16:12:00
  Transactions: 4,062,676
  Laundering: 3,380 (0.083%)

Test Set:
  Date range: 2022-09-08 16:12:00 to 2022-09-18 16:18:00
  Transactions: 1,015,669
  Laundering: 1,797 (0.177%)
============================================================
Number of nodes: 515080
Number of edges: 4062676
Number of nodes: 515080
Number of edges: 1015669
Class weights: tensor([ 1., 30.], device='cuda:0')

============================================================
TRAINING
============================================================

Epoch   0 | Loss: 0.6958 | Acc: 0.9823
  Class 1 - P: 0.0053, R: 0.1080, F1: 0.0100
  Predicting class 1: 1.70506%
  Saved best model (F1: 0.0100)

Epoch   1 | Loss: 0.6884 | Acc: 0.9386
  Class 1 - P: 0.0040, R: 0.2917, F1: 0.0078
  Predicting class 1: 6.10750%

Epoch   2 | Loss: 0.6816 | Acc: 0.8604
  Class 1 - P: 0.0028, R: 0.4763, F1: 0.0056
  Predicting class 1: 13.95201%

Epoch   3 | Loss: 0.6753 | Acc: 0.8047
  Class 1 - P: 0.0025, R: 0.5888, F1: 0.0050
  Predicting class 1: 19.54960%

Epoch   4 | Loss: 0.6689 | Acc: 0.7946
  Class 1 - P: 0.0025, R: 0.6228, F1: 0.0050
  Predicting class 1: 20.56251%

Epoch   5 | Loss: 0.6625 | Acc: 0.7838
  Class 1 - P: 0.0025, R: 0.6435, F1: 0.0049
  Predicting class 1: 21.64778%

Epoch   6 | Loss: 0.6557 | Acc: 0.7723
  Class 1 - P: 0.0024, R: 0.6607, F1: 0.0048
  Predicting class 1: 22.79985%

Epoch   7 | Loss: 0.6489 | Acc: 0.7618
  Class 1 - P: 0.0024, R: 0.6751, F1: 0.0047
  Predicting class 1: 23.84876%

Epoch   8 | Loss: 0.6425 | Acc: 0.7517
  Class 1 - P: 0.0023, R: 0.6917, F1: 0.0046
  Predicting class 1: 24.86322%

Epoch   9 | Loss: 0.6352 | Acc: 0.7436
  Class 1 - P: 0.0023, R: 0.7041, F1: 0.0045
  Predicting class 1: 25.67490%

Epoch  10 | Loss: 0.6276 | Acc: 0.7371
  Class 1 - P: 0.0023, R: 0.7127, F1: 0.0045
  Predicting class 1: 26.32445%

Epoch  11 | Loss: 0.6194 | Acc: 0.7317
  Class 1 - P: 0.0022, R: 0.7234, F1: 0.0045
  Predicting class 1: 26.86601%

Epoch  12 | Loss: 0.6107 | Acc: 0.7272
  Class 1 - P: 0.0022, R: 0.7322, F1: 0.0044
  Predicting class 1: 27.31409%

Epoch  13 | Loss: 0.6007 | Acc: 0.7231
  Class 1 - P: 0.0022, R: 0.7385, F1: 0.0044
  Predicting class 1: 27.73322%

Epoch  14 | Loss: 0.5911 | Acc: 0.7187
  Class 1 - P: 0.0022, R: 0.7453, F1: 0.0044
  Predicting class 1: 28.17532%

Epoch  15 | Loss: 0.5818 | Acc: 0.7140
  Class 1 - P: 0.0022, R: 0.7503, F1: 0.0043
  Predicting class 1: 28.64555%

Epoch  16 | Loss: 0.5715 | Acc: 0.7097
  Class 1 - P: 0.0022, R: 0.7562, F1: 0.0043
  Predicting class 1: 29.07436%

Epoch  17 | Loss: 0.5619 | Acc: 0.7067
  Class 1 - P: 0.0022, R: 0.7639, F1: 0.0043
  Predicting class 1: 29.37817%

Epoch  18 | Loss: 0.5515 | Acc: 0.7063
  Class 1 - P: 0.0022, R: 0.7672, F1: 0.0043
  Predicting class 1: 29.41546%

Epoch  19 | Loss: 0.5416 | Acc: 0.7082
  Class 1 - P: 0.0022, R: 0.7707, F1: 0.0044
  Predicting class 1: 29.22507%

Epoch  20 | Loss: 0.5335 | Acc: 0.7125
  Class 1 - P: 0.0022, R: 0.7689, F1: 0.0044
  Predicting class 1: 28.79174%

Epoch  21 | Loss: 0.5241 | Acc: 0.7308
  Class 1 - P: 0.0024, R: 0.7754, F1: 0.0048
  Predicting class 1: 26.97070%

Epoch  22 | Loss: 0.5141 | Acc: 0.7388
  Class 1 - P: 0.0025, R: 0.7849, F1: 0.0050
  Predicting class 1: 26.17130%

Epoch  23 | Loss: 0.5057 | Acc: 0.7472
  Class 1 - P: 0.0026, R: 0.7885, F1: 0.0052
  Predicting class 1: 25.33168%

Epoch  24 | Loss: 0.4964 | Acc: 0.7537
  Class 1 - P: 0.0027, R: 0.7929, F1: 0.0053
  Predicting class 1: 24.68134%

Epoch  25 | Loss: 0.4888 | Acc: 0.7685
  Class 1 - P: 0.0029, R: 0.7956, F1: 0.0057
  Predicting class 1: 23.19456%

Epoch  26 | Loss: 0.4832 | Acc: 0.7779
  Class 1 - P: 0.0030, R: 0.7967, F1: 0.0059
  Predicting class 1: 22.26202%

Epoch  27 | Loss: 0.4760 | Acc: 0.7780
  Class 1 - P: 0.0030, R: 0.8009, F1: 0.0060
  Predicting class 1: 22.24721%

Epoch  28 | Loss: 0.4703 | Acc: 0.7804
  Class 1 - P: 0.0030, R: 0.8044, F1: 0.0061
  Predicting class 1: 22.00660%

Epoch  29 | Loss: 0.4628 | Acc: 0.7830
  Class 1 - P: 0.0031, R: 0.8071, F1: 0.0062
  Predicting class 1: 21.74702%

Epoch  30 | Loss: 0.4564 | Acc: 0.7880
  Class 1 - P: 0.0032, R: 0.8047, F1: 0.0063
  Predicting class 1: 21.25176%

Epoch  31 | Loss: 0.4519 | Acc: 0.7905
  Class 1 - P: 0.0032, R: 0.8036, F1: 0.0063
  Predicting class 1: 20.99714%

Epoch  32 | Loss: 0.4508 | Acc: 0.7846
  Class 1 - P: 0.0031, R: 0.8169, F1: 0.0063
  Predicting class 1: 21.59328%

Epoch  33 | Loss: 0.4441 | Acc: 0.7887
  Class 1 - P: 0.0032, R: 0.8178, F1: 0.0064
  Predicting class 1: 21.18431%

Epoch  34 | Loss: 0.4385 | Acc: 0.8001
  Class 1 - P: 0.0034, R: 0.8071, F1: 0.0067
  Predicting class 1: 20.03943%

Epoch  35 | Loss: 0.4340 | Acc: 0.8012
  Class 1 - P: 0.0034, R: 0.8118, F1: 0.0067
  Predicting class 1: 19.93415%

Epoch  36 | Loss: 0.4261 | Acc: 0.7991
  Class 1 - P: 0.0034, R: 0.8225, F1: 0.0068
  Predicting class 1: 20.14305%

Epoch  37 | Loss: 0.4236 | Acc: 0.8061
  Class 1 - P: 0.0035, R: 0.8189, F1: 0.0070
  Predicting class 1: 19.44364%

Epoch  38 | Loss: 0.4194 | Acc: 0.8191
  Class 1 - P: 0.0037, R: 0.8095, F1: 0.0074
  Predicting class 1: 18.14353%

Epoch  39 | Loss: 0.4139 | Acc: 0.8144
  Class 1 - P: 0.0037, R: 0.8228, F1: 0.0073
  Predicting class 1: 18.61623%

Epoch  40 | Loss: 0.4053 | Acc: 0.8110
  Class 1 - P: 0.0037, R: 0.8346, F1: 0.0073
  Predicting class 1: 18.95199%

Epoch  41 | Loss: 0.4038 | Acc: 0.8276
  Class 1 - P: 0.0040, R: 0.8222, F1: 0.0079
  Predicting class 1: 17.29801%

Epoch  42 | Loss: 0.3981 | Acc: 0.8249
  Class 1 - P: 0.0040, R: 0.8364, F1: 0.0079
  Predicting class 1: 17.56241%

Epoch  43 | Loss: 0.3917 | Acc: 0.8186
  Class 1 - P: 0.0039, R: 0.8538, F1: 0.0078
  Predicting class 1: 18.20332%

Epoch  44 | Loss: 0.3881 | Acc: 0.8365
  Class 1 - P: 0.0042, R: 0.8317, F1: 0.0084
  Predicting class 1: 16.40867%

Epoch  45 | Loss: 0.3829 | Acc: 0.8375
  Class 1 - P: 0.0043, R: 0.8385, F1: 0.0085
  Predicting class 1: 16.30268%

Epoch  46 | Loss: 0.3751 | Acc: 0.8306
  Class 1 - P: 0.0042, R: 0.8589, F1: 0.0084
  Predicting class 1: 17.00305%

Epoch  47 | Loss: 0.3714 | Acc: 0.8411
  Class 1 - P: 0.0044, R: 0.8479, F1: 0.0088
  Predicting class 1: 15.95269%

Epoch  48 | Loss: 0.3656 | Acc: 0.8343
  Class 1 - P: 0.0043, R: 0.8660, F1: 0.0086
  Predicting class 1: 16.63128%

Epoch  49 | Loss: 0.3622 | Acc: 0.8330
  Class 1 - P: 0.0043, R: 0.8743, F1: 0.0086
  Predicting class 1: 16.76405%

Epoch  50 | Loss: 0.3560 | Acc: 0.8418
  Class 1 - P: 0.0045, R: 0.8648, F1: 0.0090
  Predicting class 1: 15.88000%

Epoch  51 | Loss: 0.3506 | Acc: 0.8333
  Class 1 - P: 0.0044, R: 0.8840, F1: 0.0087
  Predicting class 1: 16.73687%

Epoch  52 | Loss: 0.3456 | Acc: 0.8436
  Class 1 - P: 0.0046, R: 0.8722, F1: 0.0092
  Predicting class 1: 15.70475%

Epoch  53 | Loss: 0.3410 | Acc: 0.8455
  Class 1 - P: 0.0047, R: 0.8734, F1: 0.0093
  Predicting class 1: 15.50801%

Epoch  54 | Loss: 0.3355 | Acc: 0.8381
  Class 1 - P: 0.0046, R: 0.8941, F1: 0.0091
  Predicting class 1: 16.25229%

Epoch  55 | Loss: 0.3291 | Acc: 0.8499
  Class 1 - P: 0.0048, R: 0.8725, F1: 0.0096
  Predicting class 1: 15.07162%

Epoch  56 | Loss: 0.3248 | Acc: 0.8323
  Class 1 - P: 0.0045, R: 0.9160, F1: 0.0090
  Predicting class 1: 16.84198%

Epoch  57 | Loss: 0.3217 | Acc: 0.8534
  Class 1 - P: 0.0050, R: 0.8793, F1: 0.0099
  Predicting class 1: 14.71872%

Epoch  58 | Loss: 0.3166 | Acc: 0.8348
  Class 1 - P: 0.0046, R: 0.9222, F1: 0.0092
  Predicting class 1: 16.59089%

Epoch  59 | Loss: 0.3146 | Acc: 0.8524
  Class 1 - P: 0.0050, R: 0.8970, F1: 0.0100
  Predicting class 1: 14.82902%

Epoch  60 | Loss: 0.3079 | Acc: 0.8591
  Class 1 - P: 0.0052, R: 0.8891, F1: 0.0104
  Predicting class 1: 14.15370%
  Saved best model (F1: 0.0104)

Epoch  61 | Loss: 0.3020 | Acc: 0.8382
  Class 1 - P: 0.0048, R: 0.9308, F1: 0.0095
  Predicting class 1: 16.24865%

Epoch  62 | Loss: 0.2996 | Acc: 0.8622
  Class 1 - P: 0.0053, R: 0.8882, F1: 0.0106
  Predicting class 1: 13.84730%
  Saved best model (F1: 0.0106)

Epoch  63 | Loss: 0.2957 | Acc: 0.8466
  Class 1 - P: 0.0050, R: 0.9263, F1: 0.0099
  Predicting class 1: 15.41221%

Epoch  64 | Loss: 0.2902 | Acc: 0.8473
  Class 1 - P: 0.0050, R: 0.9287, F1: 0.0100
  Predicting class 1: 15.34183%

Epoch  65 | Loss: 0.2870 | Acc: 0.8674
  Class 1 - P: 0.0056, R: 0.8941, F1: 0.0111
  Predicting class 1: 13.32403%
  Saved best model (F1: 0.0111)

Epoch  66 | Loss: 0.2863 | Acc: 0.8423
  Class 1 - P: 0.0049, R: 0.9396, F1: 0.0098
  Predicting class 1: 15.84463%

Epoch  67 | Loss: 0.2824 | Acc: 0.8609
  Class 1 - P: 0.0054, R: 0.9112, F1: 0.0108
  Predicting class 1: 13.97662%

Epoch  68 | Loss: 0.2766 | Acc: 0.8697
  Class 1 - P: 0.0057, R: 0.8973, F1: 0.0113
  Predicting class 1: 13.09396%
  Saved best model (F1: 0.0113)

Epoch  69 | Loss: 0.2741 | Acc: 0.8386
  Class 1 - P: 0.0049, R: 0.9521, F1: 0.0097
  Predicting class 1: 16.21033%

Epoch  70 | Loss: 0.2727 | Acc: 0.8624
  Class 1 - P: 0.0055, R: 0.9189, F1: 0.0110
  Predicting class 1: 13.83364%

Epoch  71 | Loss: 0.2671 | Acc: 0.8614
  Class 1 - P: 0.0055, R: 0.9243, F1: 0.0110
  Predicting class 1: 13.92599%

Epoch  72 | Loss: 0.2638 | Acc: 0.8458
  Class 1 - P: 0.0051, R: 0.9476, F1: 0.0101
  Predicting class 1: 15.49481%

Epoch  73 | Loss: 0.2631 | Acc: 0.8680
  Class 1 - P: 0.0057, R: 0.9172, F1: 0.0114
  Predicting class 1: 13.27248%
  Saved best model (F1: 0.0114)

Epoch  74 | Loss: 0.2584 | Acc: 0.8640
  Class 1 - P: 0.0056, R: 0.9284, F1: 0.0112
  Predicting class 1: 13.67598%

Epoch  75 | Loss: 0.2542 | Acc: 0.8487
  Class 1 - P: 0.0052, R: 0.9512, F1: 0.0104
  Predicting class 1: 15.20616%

Epoch  76 | Loss: 0.2518 | Acc: 0.8628
  Class 1 - P: 0.0056, R: 0.9349, F1: 0.0112
  Predicting class 1: 13.79251%

Epoch  77 | Loss: 0.2498 | Acc: 0.8575
  Class 1 - P: 0.0055, R: 0.9435, F1: 0.0109
  Predicting class 1: 14.31995%

Epoch  78 | Loss: 0.2480 | Acc: 0.8554
  Class 1 - P: 0.0054, R: 0.9509, F1: 0.0108
  Predicting class 1: 14.53261%

Epoch  79 | Loss: 0.2447 | Acc: 0.8698
  Class 1 - P: 0.0059, R: 0.9269, F1: 0.0117
  Predicting class 1: 13.08864%
  Saved best model (F1: 0.0117)

Epoch  80 | Loss: 0.2415 | Acc: 0.8649
  Class 1 - P: 0.0057, R: 0.9376, F1: 0.0114
  Predicting class 1: 13.58464%

Epoch  81 | Loss: 0.2422 | Acc: 0.8573
  Class 1 - P: 0.0055, R: 0.9524, F1: 0.0110
  Predicting class 1: 14.34702%

Epoch  82 | Loss: 0.2382 | Acc: 0.8715
  Class 1 - P: 0.0060, R: 0.9317, F1: 0.0119
  Predicting class 1: 12.92461%
  Saved best model (F1: 0.0119)

Epoch  83 | Loss: 0.2360 | Acc: 0.8507
  Class 1 - P: 0.0053, R: 0.9648, F1: 0.0106
  Predicting class 1: 15.00846%

Epoch  84 | Loss: 0.2360 | Acc: 0.8639
  Class 1 - P: 0.0058, R: 0.9456, F1: 0.0114
  Predicting class 1: 13.68064%

Epoch  85 | Loss: 0.2342 | Acc: 0.8633
  Class 1 - P: 0.0058, R: 0.9503, F1: 0.0114
  Predicting class 1: 13.74850%

Epoch  86 | Loss: 0.2294 | Acc: 0.8586
  Class 1 - P: 0.0056, R: 0.9580, F1: 0.0112
  Predicting class 1: 14.21226%

Epoch  87 | Loss: 0.2284 | Acc: 0.8730
  Class 1 - P: 0.0061, R: 0.9334, F1: 0.0121
  Predicting class 1: 12.77340%
  Saved best model (F1: 0.0121)

Epoch  88 | Loss: 0.2289 | Acc: 0.8697
  Class 1 - P: 0.0060, R: 0.9388, F1: 0.0118
  Predicting class 1: 13.10274%

Epoch  89 | Loss: 0.2226 | Acc: 0.8628
  Class 1 - P: 0.0058, R: 0.9544, F1: 0.0114
  Predicting class 1: 13.79957%

Epoch  90 | Loss: 0.2237 | Acc: 0.8676
  Class 1 - P: 0.0059, R: 0.9497, F1: 0.0118
  Predicting class 1: 13.31679%

Epoch  91 | Loss: 0.2232 | Acc: 0.8560
  Class 1 - P: 0.0056, R: 0.9689, F1: 0.0111
  Predicting class 1: 14.47455%

Epoch  92 | Loss: 0.2226 | Acc: 0.8683
  Class 1 - P: 0.0060, R: 0.9497, F1: 0.0119
  Predicting class 1: 13.24322%

Epoch  93 | Loss: 0.2179 | Acc: 0.8612
  Class 1 - P: 0.0057, R: 0.9618, F1: 0.0114
  Predicting class 1: 13.95920%

Epoch  94 | Loss: 0.2186 | Acc: 0.8604
  Class 1 - P: 0.0057, R: 0.9621, F1: 0.0113
  Predicting class 1: 14.03663%

Epoch  95 | Loss: 0.2198 | Acc: 0.8697
  Class 1 - P: 0.0060, R: 0.9521, F1: 0.0120
  Predicting class 1: 13.10124%

Epoch  96 | Loss: 0.2158 | Acc: 0.8594
  Class 1 - P: 0.0057, R: 0.9663, F1: 0.0113
  Predicting class 1: 14.13364%

Epoch  97 | Loss: 0.2138 | Acc: 0.8601
  Class 1 - P: 0.0057, R: 0.9675, F1: 0.0114
  Predicting class 1: 14.06711%

Epoch  98 | Loss: 0.2141 | Acc: 0.8645
  Class 1 - P: 0.0059, R: 0.9639, F1: 0.0117
  Predicting class 1: 13.63200%

Epoch  99 | Loss: 0.2101 | Acc: 0.8651
  Class 1 - P: 0.0059, R: 0.9630, F1: 0.0117
  Predicting class 1: 13.56660%

============================================================
TRAINING COMPLETE
============================================================
Class 0: 1013872 (99.82%)
Class 1: 1797 (0.18%)

============================================================
TEST SET RESULTS
============================================================
Overall Accuracy: 0.9045
AUC-ROC: 0.9667

Confusion Matrix:
  TN:  917097  FP:   96775
  FN:     207  TP:    1590

Class 0 (Legitimate):
  Precision: 0.9998
  Recall: 0.9045

Class 1 (Laundering):
  Precision: 0.0162
  Recall: 0.8848
  F1 Score: 0.0317
============================================================

============================================================
EVALUATION COMPLETE
============================================================
==========================================
Training completed successfully!
Output saved to: ./saved_models/
==========================================
Job completed at: Fri Nov 14 11:17:50 AM +08 2025
==========================================
