==========================================
Job ID: 283620
Job Name: dgl_gnn_train
Node: xgpi2
Start Time: Fri Nov 14 11:20:38 AM +08 2025
GPU Information:
Fri Nov 14 11:20:38 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 NVL                On  |   00000000:E3:00.0 Off |                    0 |
| N/A   36C    P0             67W /  400W |       0MiB /  95830MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==========================================
Conda environment 'aml_project_new' already exists. Activating it...
Working directory: /home/l/linchieh/AML-GNN-project/classifier_src_soc
==========================================
Starting fine-tuning...
Output directory: ./saved_models/
Epochs: 100
Learning rate: 1e-4
==========================================
Preparing dataset
Warning: Looks like you're using an outdated `kagglehub` version, please consider updating (latest version: 0.3.13)
Path to dataset files: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8
Begin main loop
CUDA available: True
Loading HI-Small...


Loading transactions from: /home/l/linchieh/.cache/kagglehub/datasets/ealtman2019/ibm-transactions-for-anti-money-laundering-aml/versions/8/HI-Small_Trans.csv
File size: 453.6 MB

Loaded 5,078,345 transactions
Date range: 2022-09-01 00:00:00 to 2022-09-18 16:18:00
Laundering transactions: 5,177 (0.102%)
============================================================
TEMPORAL TRAIN/TEST SPLIT
============================================================

Train Set:
  Date range: 2022-09-01 00:00:00 to 2022-09-08 16:12:00
  Transactions: 4,062,676
  Laundering: 3,380 (0.083%)

Test Set:
  Date range: 2022-09-08 16:12:00 to 2022-09-18 16:18:00
  Transactions: 1,015,669
  Laundering: 1,797 (0.177%)
============================================================
Number of nodes: 515080
Number of edges: 4062676
Number of nodes: 515080
Number of edges: 1015669
Class weights: tensor([  1., 100.], device='cuda:0')

============================================================
TRAINING
============================================================

Epoch   0 | Loss: 0.6917 | Acc: 0.6558
  Class 1 - P: 0.0018, R: 0.7586, F1: 0.0037
  Predicting class 1: 34.46349%
  Saved best model (F1: 0.0037)

Epoch   1 | Loss: 0.6842 | Acc: 0.7203
  Class 1 - P: 0.0022, R: 0.7237, F1: 0.0043
  Predicting class 1: 28.00238%
  Saved best model (F1: 0.0043)

Epoch   2 | Loss: 0.6772 | Acc: 0.7316
  Class 1 - P: 0.0022, R: 0.7003, F1: 0.0043
  Predicting class 1: 26.87056%
  Saved best model (F1: 0.0043)

Epoch   3 | Loss: 0.6699 | Acc: 0.7302
  Class 1 - P: 0.0022, R: 0.7018, F1: 0.0043
  Predicting class 1: 27.01274%

Epoch   4 | Loss: 0.6633 | Acc: 0.7304
  Class 1 - P: 0.0022, R: 0.7083, F1: 0.0044
  Predicting class 1: 26.99130%
  Saved best model (F1: 0.0044)

Epoch   5 | Loss: 0.6551 | Acc: 0.7280
  Class 1 - P: 0.0022, R: 0.7195, F1: 0.0044
  Predicting class 1: 27.23887%
  Saved best model (F1: 0.0044)

Epoch   6 | Loss: 0.6476 | Acc: 0.7243
  Class 1 - P: 0.0022, R: 0.7278, F1: 0.0044
  Predicting class 1: 27.61052%

Epoch   7 | Loss: 0.6395 | Acc: 0.7201
  Class 1 - P: 0.0022, R: 0.7364, F1: 0.0044
  Predicting class 1: 28.02542%

Epoch   8 | Loss: 0.6314 | Acc: 0.7158
  Class 1 - P: 0.0022, R: 0.7450, F1: 0.0043
  Predicting class 1: 28.45890%

Epoch   9 | Loss: 0.6223 | Acc: 0.7117
  Class 1 - P: 0.0022, R: 0.7512, F1: 0.0043
  Predicting class 1: 28.87476%

Epoch  10 | Loss: 0.6136 | Acc: 0.7082
  Class 1 - P: 0.0021, R: 0.7550, F1: 0.0043
  Predicting class 1: 29.22465%

Epoch  11 | Loss: 0.6045 | Acc: 0.7050
  Class 1 - P: 0.0021, R: 0.7574, F1: 0.0043
  Predicting class 1: 29.54331%

Epoch  12 | Loss: 0.5946 | Acc: 0.7024
  Class 1 - P: 0.0021, R: 0.7624, F1: 0.0042
  Predicting class 1: 29.80602%

Epoch  13 | Loss: 0.5849 | Acc: 0.7003
  Class 1 - P: 0.0021, R: 0.7669, F1: 0.0042
  Predicting class 1: 30.01925%

Epoch  14 | Loss: 0.5748 | Acc: 0.6986
  Class 1 - P: 0.0021, R: 0.7716, F1: 0.0042
  Predicting class 1: 30.18126%

Epoch  15 | Loss: 0.5640 | Acc: 0.6973
  Class 1 - P: 0.0021, R: 0.7757, F1: 0.0042
  Predicting class 1: 30.31438%

Epoch  16 | Loss: 0.5542 | Acc: 0.6964
  Class 1 - P: 0.0021, R: 0.7820, F1: 0.0043
  Predicting class 1: 30.40329%

Epoch  17 | Loss: 0.5441 | Acc: 0.6958
  Class 1 - P: 0.0021, R: 0.7873, F1: 0.0043
  Predicting class 1: 30.46566%

Epoch  18 | Loss: 0.5343 | Acc: 0.6959
  Class 1 - P: 0.0022, R: 0.7888, F1: 0.0043
  Predicting class 1: 30.45500%

Epoch  19 | Loss: 0.5257 | Acc: 0.7042
  Class 1 - P: 0.0022, R: 0.7935, F1: 0.0044
  Predicting class 1: 29.63054%
  Saved best model (F1: 0.0044)

Epoch  20 | Loss: 0.5156 | Acc: 0.7164
  Class 1 - P: 0.0023, R: 0.7979, F1: 0.0047
  Predicting class 1: 28.41386%
  Saved best model (F1: 0.0047)

Epoch  21 | Loss: 0.5060 | Acc: 0.7223
  Class 1 - P: 0.0024, R: 0.7953, F1: 0.0047
  Predicting class 1: 27.82107%
  Saved best model (F1: 0.0047)

Epoch  22 | Loss: 0.4973 | Acc: 0.7363
  Class 1 - P: 0.0025, R: 0.7979, F1: 0.0050
  Predicting class 1: 26.41712%
  Saved best model (F1: 0.0050)

Epoch  23 | Loss: 0.4914 | Acc: 0.7491
  Class 1 - P: 0.0027, R: 0.8030, F1: 0.0053
  Predicting class 1: 25.14006%
  Saved best model (F1: 0.0053)

Epoch  24 | Loss: 0.4839 | Acc: 0.7601
  Class 1 - P: 0.0028, R: 0.8083, F1: 0.0056
  Predicting class 1: 24.04206%
  Saved best model (F1: 0.0056)

Epoch  25 | Loss: 0.4755 | Acc: 0.7705
  Class 1 - P: 0.0029, R: 0.8104, F1: 0.0058
  Predicting class 1: 23.00225%
  Saved best model (F1: 0.0058)

Epoch  26 | Loss: 0.4695 | Acc: 0.7768
  Class 1 - P: 0.0030, R: 0.8095, F1: 0.0060
  Predicting class 1: 22.37641%
  Saved best model (F1: 0.0060)

Epoch  27 | Loss: 0.4619 | Acc: 0.7815
  Class 1 - P: 0.0031, R: 0.8098, F1: 0.0061
  Predicting class 1: 21.90293%
  Saved best model (F1: 0.0061)

Epoch  28 | Loss: 0.4567 | Acc: 0.7852
  Class 1 - P: 0.0031, R: 0.8101, F1: 0.0062
  Predicting class 1: 21.53133%
  Saved best model (F1: 0.0062)

Epoch  29 | Loss: 0.4504 | Acc: 0.7865
  Class 1 - P: 0.0032, R: 0.8160, F1: 0.0063
  Predicting class 1: 21.39993%
  Saved best model (F1: 0.0063)

Epoch  30 | Loss: 0.4456 | Acc: 0.7891
  Class 1 - P: 0.0032, R: 0.8183, F1: 0.0064
  Predicting class 1: 21.14793%
  Saved best model (F1: 0.0064)

Epoch  31 | Loss: 0.4401 | Acc: 0.7902
  Class 1 - P: 0.0033, R: 0.8246, F1: 0.0065
  Predicting class 1: 21.03397%
  Saved best model (F1: 0.0065)

Epoch  32 | Loss: 0.4337 | Acc: 0.7946
  Class 1 - P: 0.0033, R: 0.8254, F1: 0.0066
  Predicting class 1: 20.59773%
  Saved best model (F1: 0.0066)

Epoch  33 | Loss: 0.4303 | Acc: 0.7964
  Class 1 - P: 0.0034, R: 0.8290, F1: 0.0067
  Predicting class 1: 20.41822%
  Saved best model (F1: 0.0067)

Epoch  34 | Loss: 0.4232 | Acc: 0.8029
  Class 1 - P: 0.0035, R: 0.8290, F1: 0.0069
  Predicting class 1: 19.76544%
  Saved best model (F1: 0.0069)

Epoch  35 | Loss: 0.4184 | Acc: 0.8062
  Class 1 - P: 0.0036, R: 0.8314, F1: 0.0071
  Predicting class 1: 19.43847%
  Saved best model (F1: 0.0071)

Epoch  36 | Loss: 0.4105 | Acc: 0.8148
  Class 1 - P: 0.0037, R: 0.8254, F1: 0.0074
  Predicting class 1: 18.56998%
  Saved best model (F1: 0.0074)

Epoch  37 | Loss: 0.4069 | Acc: 0.8164
  Class 1 - P: 0.0038, R: 0.8314, F1: 0.0075
  Predicting class 1: 18.41572%
  Saved best model (F1: 0.0075)

Epoch  38 | Loss: 0.4001 | Acc: 0.8190
  Class 1 - P: 0.0038, R: 0.8379, F1: 0.0076
  Predicting class 1: 18.15404%
  Saved best model (F1: 0.0076)

Epoch  39 | Loss: 0.3972 | Acc: 0.8258
  Class 1 - P: 0.0040, R: 0.8376, F1: 0.0079
  Predicting class 1: 17.48045%
  Saved best model (F1: 0.0079)

Epoch  40 | Loss: 0.3908 | Acc: 0.8268
  Class 1 - P: 0.0040, R: 0.8438, F1: 0.0080
  Predicting class 1: 17.37414%
  Saved best model (F1: 0.0080)

Epoch  41 | Loss: 0.3851 | Acc: 0.8260
  Class 1 - P: 0.0041, R: 0.8550, F1: 0.0081
  Predicting class 1: 17.46014%
  Saved best model (F1: 0.0081)

Epoch  42 | Loss: 0.3810 | Acc: 0.8336
  Class 1 - P: 0.0043, R: 0.8533, F1: 0.0085
  Predicting class 1: 16.69395%
  Saved best model (F1: 0.0085)

Epoch  43 | Loss: 0.3731 | Acc: 0.8373
  Class 1 - P: 0.0044, R: 0.8538, F1: 0.0087
  Predicting class 1: 16.32705%
  Saved best model (F1: 0.0087)

Epoch  44 | Loss: 0.3663 | Acc: 0.8357
  Class 1 - P: 0.0044, R: 0.8639, F1: 0.0087
  Predicting class 1: 16.48620%
  Saved best model (F1: 0.0087)

Epoch  45 | Loss: 0.3602 | Acc: 0.8468
  Class 1 - P: 0.0046, R: 0.8524, F1: 0.0092
  Predicting class 1: 15.37509%
  Saved best model (F1: 0.0092)

Epoch  46 | Loss: 0.3572 | Acc: 0.8300
  Class 1 - P: 0.0043, R: 0.8873, F1: 0.0086
  Predicting class 1: 17.06338%

Epoch  47 | Loss: 0.3511 | Acc: 0.8485
  Class 1 - P: 0.0047, R: 0.8633, F1: 0.0094
  Predicting class 1: 15.21032%
  Saved best model (F1: 0.0094)

Epoch  48 | Loss: 0.3458 | Acc: 0.8405
  Class 1 - P: 0.0046, R: 0.8825, F1: 0.0091
  Predicting class 1: 16.01065%

Epoch  49 | Loss: 0.3400 | Acc: 0.8380
  Class 1 - P: 0.0046, R: 0.8923, F1: 0.0091
  Predicting class 1: 16.26888%

Epoch  50 | Loss: 0.3327 | Acc: 0.8538
  Class 1 - P: 0.0049, R: 0.8675, F1: 0.0098
  Predicting class 1: 14.67986%
  Saved best model (F1: 0.0098)

Epoch  51 | Loss: 0.3284 | Acc: 0.8398
  Class 1 - P: 0.0047, R: 0.9030, F1: 0.0093
  Predicting class 1: 16.08826%

Epoch  52 | Loss: 0.3219 | Acc: 0.8517
  Class 1 - P: 0.0049, R: 0.8846, F1: 0.0098
  Predicting class 1: 14.89875%
  Saved best model (F1: 0.0098)

Epoch  53 | Loss: 0.3170 | Acc: 0.8498
  Class 1 - P: 0.0049, R: 0.8967, F1: 0.0098
  Predicting class 1: 15.08715%
  Saved best model (F1: 0.0098)

Epoch  54 | Loss: 0.3129 | Acc: 0.8405
  Class 1 - P: 0.0048, R: 0.9178, F1: 0.0095
  Predicting class 1: 16.02321%

Epoch  55 | Loss: 0.3062 | Acc: 0.8545
  Class 1 - P: 0.0051, R: 0.8944, F1: 0.0101
  Predicting class 1: 14.61121%
  Saved best model (F1: 0.0101)

Epoch  56 | Loss: 0.3023 | Acc: 0.8413
  Class 1 - P: 0.0048, R: 0.9293, F1: 0.0096
  Predicting class 1: 15.94146%

Epoch  57 | Loss: 0.2972 | Acc: 0.8539
  Class 1 - P: 0.0052, R: 0.9104, F1: 0.0103
  Predicting class 1: 14.67848%
  Saved best model (F1: 0.0103)

Epoch  58 | Loss: 0.2910 | Acc: 0.8583
  Class 1 - P: 0.0053, R: 0.9080, F1: 0.0105
  Predicting class 1: 14.23778%
  Saved best model (F1: 0.0105)

Epoch  59 | Loss: 0.2877 | Acc: 0.8478
  Class 1 - P: 0.0051, R: 0.9325, F1: 0.0101
  Predicting class 1: 15.29632%

Epoch  60 | Loss: 0.2828 | Acc: 0.8681
  Class 1 - P: 0.0056, R: 0.8976, F1: 0.0112
  Predicting class 1: 13.25538%
  Saved best model (F1: 0.0112)

Epoch  61 | Loss: 0.2782 | Acc: 0.8474
  Class 1 - P: 0.0051, R: 0.9411, F1: 0.0102
  Predicting class 1: 15.33428%

Epoch  62 | Loss: 0.2739 | Acc: 0.8552
  Class 1 - P: 0.0053, R: 0.9334, F1: 0.0106
  Predicting class 1: 14.55413%

Epoch  63 | Loss: 0.2685 | Acc: 0.8609
  Class 1 - P: 0.0055, R: 0.9243, F1: 0.0109
  Predicting class 1: 13.98216%

Epoch  64 | Loss: 0.2656 | Acc: 0.8489
  Class 1 - P: 0.0052, R: 0.9515, F1: 0.0104
  Predicting class 1: 15.18986%

Epoch  65 | Loss: 0.2616 | Acc: 0.8730
  Class 1 - P: 0.0059, R: 0.9121, F1: 0.0118
  Predicting class 1: 12.76978%
  Saved best model (F1: 0.0118)

Epoch  66 | Loss: 0.2582 | Acc: 0.8582
  Class 1 - P: 0.0055, R: 0.9408, F1: 0.0109
  Predicting class 1: 14.25014%

Epoch  67 | Loss: 0.2558 | Acc: 0.8565
  Class 1 - P: 0.0055, R: 0.9476, F1: 0.0109
  Predicting class 1: 14.42510%

Epoch  68 | Loss: 0.2513 | Acc: 0.8671
  Class 1 - P: 0.0058, R: 0.9284, F1: 0.0115
  Predicting class 1: 13.36592%

Epoch  69 | Loss: 0.2492 | Acc: 0.8474
  Class 1 - P: 0.0052, R: 0.9648, F1: 0.0104
  Predicting class 1: 15.33285%

Epoch  70 | Loss: 0.2477 | Acc: 0.8668
  Class 1 - P: 0.0058, R: 0.9328, F1: 0.0115
  Predicting class 1: 13.38898%

Epoch  71 | Loss: 0.2429 | Acc: 0.8635
  Class 1 - P: 0.0057, R: 0.9447, F1: 0.0114
  Predicting class 1: 13.72600%

Epoch  72 | Loss: 0.2403 | Acc: 0.8505
  Class 1 - P: 0.0053, R: 0.9642, F1: 0.0106
  Predicting class 1: 15.02232%

Epoch  73 | Loss: 0.2390 | Acc: 0.8803
  Class 1 - P: 0.0063, R: 0.9169, F1: 0.0126
  Predicting class 1: 12.04051%
  Saved best model (F1: 0.0126)

Epoch  74 | Loss: 0.2393 | Acc: 0.8562
  Class 1 - P: 0.0055, R: 0.9598, F1: 0.0110
  Predicting class 1: 14.45663%

Epoch  75 | Loss: 0.2313 | Acc: 0.8557
  Class 1 - P: 0.0055, R: 0.9621, F1: 0.0110
  Predicting class 1: 14.50283%

Epoch  76 | Loss: 0.2303 | Acc: 0.8682
  Class 1 - P: 0.0059, R: 0.9420, F1: 0.0117
  Predicting class 1: 13.25776%

Epoch  77 | Loss: 0.2281 | Acc: 0.8571
  Class 1 - P: 0.0056, R: 0.9633, F1: 0.0111
  Predicting class 1: 14.36974%

Epoch  78 | Loss: 0.2263 | Acc: 0.8576
  Class 1 - P: 0.0056, R: 0.9624, F1: 0.0111
  Predicting class 1: 14.31315%

Epoch  79 | Loss: 0.2240 | Acc: 0.8762
  Class 1 - P: 0.0063, R: 0.9361, F1: 0.0124
  Predicting class 1: 12.45283%

Epoch  80 | Loss: 0.2244 | Acc: 0.8578
  Class 1 - P: 0.0056, R: 0.9645, F1: 0.0112
  Predicting class 1: 14.30171%

Epoch  81 | Loss: 0.2205 | Acc: 0.8644
  Class 1 - P: 0.0058, R: 0.9589, F1: 0.0116
  Predicting class 1: 13.63931%

Epoch  82 | Loss: 0.2191 | Acc: 0.8690
  Class 1 - P: 0.0060, R: 0.9544, F1: 0.0120
  Predicting class 1: 13.17814%

Epoch  83 | Loss: 0.2187 | Acc: 0.8532
  Class 1 - P: 0.0055, R: 0.9746, F1: 0.0109
  Predicting class 1: 14.75498%

Epoch  84 | Loss: 0.2166 | Acc: 0.8630
  Class 1 - P: 0.0058, R: 0.9621, F1: 0.0116
  Predicting class 1: 13.77196%

Epoch  85 | Loss: 0.2148 | Acc: 0.8672
  Class 1 - P: 0.0060, R: 0.9580, F1: 0.0119
  Predicting class 1: 13.35551%

Epoch  86 | Loss: 0.2136 | Acc: 0.8543
  Class 1 - P: 0.0055, R: 0.9743, F1: 0.0110
  Predicting class 1: 14.64892%

Epoch  87 | Loss: 0.2146 | Acc: 0.8635
  Class 1 - P: 0.0058, R: 0.9633, F1: 0.0116
  Predicting class 1: 13.72581%

Epoch  88 | Loss: 0.2104 | Acc: 0.8703
  Class 1 - P: 0.0061, R: 0.9550, F1: 0.0121
  Predicting class 1: 13.04933%

Epoch  89 | Loss: 0.2089 | Acc: 0.8551
  Class 1 - P: 0.0056, R: 0.9766, F1: 0.0111
  Predicting class 1: 14.56931%

Epoch  90 | Loss: 0.2100 | Acc: 0.8628
  Class 1 - P: 0.0058, R: 0.9672, F1: 0.0116
  Predicting class 1: 13.79502%

Epoch  91 | Loss: 0.2064 | Acc: 0.8766
  Class 1 - P: 0.0064, R: 0.9497, F1: 0.0126
  Predicting class 1: 12.41718%
  Saved best model (F1: 0.0126)

Epoch  92 | Loss: 0.2092 | Acc: 0.8558
  Class 1 - P: 0.0056, R: 0.9757, F1: 0.0111
  Predicting class 1: 14.49810%

Epoch  93 | Loss: 0.2054 | Acc: 0.8618
  Class 1 - P: 0.0058, R: 0.9704, F1: 0.0116
  Predicting class 1: 13.89328%

Epoch  94 | Loss: 0.2027 | Acc: 0.8707
  Class 1 - P: 0.0061, R: 0.9601, F1: 0.0122
  Predicting class 1: 13.00780%

Epoch  95 | Loss: 0.2028 | Acc: 0.8585
  Class 1 - P: 0.0057, R: 0.9763, F1: 0.0114
  Predicting class 1: 14.22981%

Epoch  96 | Loss: 0.2027 | Acc: 0.8592
  Class 1 - P: 0.0057, R: 0.9749, F1: 0.0114
  Predicting class 1: 14.16143%

Epoch  97 | Loss: 0.2011 | Acc: 0.8732
  Class 1 - P: 0.0062, R: 0.9580, F1: 0.0124
  Predicting class 1: 12.75681%

Epoch  98 | Loss: 0.2014 | Acc: 0.8647
  Class 1 - P: 0.0059, R: 0.9704, F1: 0.0118
  Predicting class 1: 13.61280%

Epoch  99 | Loss: 0.1995 | Acc: 0.8596
  Class 1 - P: 0.0057, R: 0.9751, F1: 0.0114
  Predicting class 1: 14.12293%

============================================================
TRAINING COMPLETE
============================================================
Class 0: 1013872 (99.82%)
Class 1: 1797 (0.18%)

============================================================
TEST SET RESULTS
============================================================
Overall Accuracy: 0.8722
AUC-ROC: 0.9648

Confusion Matrix:
  TN:  884239  FP:  129633
  FN:     187  TP:    1610

Class 0 (Legitimate):
  Precision: 0.9998
  Recall: 0.8721

Class 1 (Laundering):
  Precision: 0.0123
  Recall: 0.8959
  F1 Score: 0.0242
============================================================

============================================================
EVALUATION COMPLETE
============================================================
==========================================
Training completed successfully!
Output saved to: ./saved_models/
==========================================
Job completed at: Fri Nov 14 11:27:24 AM +08 2025
==========================================
